<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-08-02">

<title>The /t/ release in Jutland Danish. Decomposing the spectrum with functional PCA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods-and-materials" id="toc-methods-and-materials" class="nav-link" data-scroll-target="#methods-and-materials"><span class="header-section-number">2</span> Methods and materials</a>
  <ul class="collapse">
  <li><a href="#recordings" id="toc-recordings" class="nav-link" data-scroll-target="#recordings"><span class="header-section-number">2.1</span> Recordings</a></li>
  <li><a href="#acoustic-processing" id="toc-acoustic-processing" class="nav-link" data-scroll-target="#acoustic-processing"><span class="header-section-number">2.2</span> Acoustic processing</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a></li>
  <li><a href="#discussion-and-conclusions" id="toc-discussion-and-conclusions" class="nav-link" data-scroll-target="#discussion-and-conclusions"><span class="header-section-number">4</span> Discussion and conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The /t/ release in Jutland Danish. Decomposing the spectrum with functional PCA</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Rasmus Puggaard-Rode <a href="https://orcid.org/0000-0003-4522-9987" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Institute for Phonetics and Speech Processing, <br> Ludwig Maximilian University, Munich
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 2, 2023</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>This study concerns variation in the realization of /t/ in Danish. /t/ is prominently affricated in Modern Standard Danish, but affrication is known to have been missing in some of the regional varieties that used to be spoken in Jutland. It remains unclear exactly which varieties lacked affrication. Due to relatively recent major changes in language policy and mobility, the traditional Danish dialect landscape has undergone rapid levelling, so we explore this problem using a large corpus of recordings of elderly speakers from the 1970s. We propose using the functional extension of principal component analysis to decompose the sources of spectral variance in stop release midpoints, and use the results as a proxy for determining affrication status. We find that /t/ affrication was limited to parts of eastern Jutland, perhaps due to early adaptation of the feature in some of the area’s largest cities.</p>
  </div>
</div>

</header>

<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What’s this?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a so-called ‘callout block’. You’ll find them spread throughout the text. The text is otherwise identical to the version published in the <em>ICPhS</em> proceedings, except it uses the colorful versions of plots that were used in my <em>ICPhS</em> presentation. The callout blocks mostly contain software-specific technical details about how the analysis was implemented, how plots were generated etc in the R language – generally along with explanations in prose about what the individual commands do and how they work. Sometimes they just contain additional technical details. In several cases they contain plots and details that were part of the presentation at <em>ICPhS</em>, but were not part of the proceedings paper. Instead of placing all this in a repository separate from the manuscript, this is an attempt to incorporate it directly into the paper, so that looking up technical details is as easy and simple as possible. This particular paper has a lot of technical detail in very little space, making it potentially very handy to be able to look up the implementation details.</p>
<p>The main analysis for this paper was done in early 2022. The analysis was included in my dissertation <span class="citation" data-cites="puggaardrode2023_diss">(<a href="#ref-puggaardrode2023_diss" role="doc-biblioref">Puggaard-Rode 2023</a>)</span>, and analysis data and code are already published <span class="citation" data-cites="disscode">(see <a href="#ref-disscode" role="doc-biblioref">Puggaard-Rode 2022a</a>)</span>. The analysis code presented here is substantially the same, but my R skills have significantly improved since, so the code has been updated or rewritten for improved legibility. If you are interested in reproducing the specific grayscale plots from the proceedings paper, please consult <span class="citation" data-cites="disscode">Puggaard-Rode (<a href="#ref-disscode" role="doc-biblioref">2022a</a>)</span>.</p>
</div>
</div>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The aims of this study are twofold: 1) to explore the geographical distribution of (missing) /t/ affrication in traditional varieties of Jutland Danish (see <a href="#fig-mapDK">Figure&nbsp;1</a>), and 2) to explore the use of functional principal component analysis <span class="citation" data-cites="gubian2015">(FPCA, <a href="#ref-gubian2015" role="doc-biblioref">Gubian, Torreira &amp; Boves 2015</a>)</span> for compressing the information in speech spectra into a small number of easily interpretable discrete variables.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Generating the map in <a href="#fig-mapDK">Figure&nbsp;1</a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="#fig-mapDK">Figure&nbsp;1</a> shows Denmark and its immediate neighbors, and colors in some important landmarks. In order to make this map natively in R, we load in the packages <code>tidyverse</code> (which will be used for data manipulation and plotting throughout the paper), <code>patchwork</code>, and <code>eurostat</code>. <code>eurostat</code> provides wrappers for loading Eurostat data into R, including e.g.&nbsp;coordinates for select countries with the <code>get_eurostat_geospatial()</code> function as below. I set <code>resolution = '1'</code> to get the highest possible resolution. <code>nuts_level</code> refers to Eurostat’s NUTS level (<strong>n</strong>omenclature of <strong>t</strong>erritorial <strong>u</strong>nits for <strong>s</strong>tatistics, and I agree – that’s not a very satisfying abbreviation). The <code>nuts_level</code> determines the granularity of the regions that maps are divided into. <code>3</code> is the right granularity here – <code>2</code> would give us the official regions of Denmark, which would not allow us to easily separate Jutland from the rest of the country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eurostat)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>geodata <span class="ot">&lt;-</span> <span class="fu">get_eurostat_geospatial</span>(<span class="at">resolution =</span> <span class="st">'1'</span>, <span class="at">nuts_level =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Coordinates for specific countries can then be accessed by filtering the resulting <code>geodata</code> object by the country codes that are stored in <code>geodata$CNTR_CODE</code>. I’ll grab the data for Denmark, Germany, and Sweden, so I can show where Denmark is located relative to the bordering countries. Each of these filtered objects will include coordinate data sorted into regions by NUTS unit. I further split the Danish coordinates into the NUTS units belonging to Jutland and those not belonging to Jutland.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>geodataDK <span class="ot">&lt;-</span> geodata[geodata<span class="sc">$</span>CNTR_CODE<span class="sc">==</span><span class="st">'DK'</span>,]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>geodataDE <span class="ot">&lt;-</span> geodata[geodata<span class="sc">$</span>CNTR_CODE<span class="sc">==</span><span class="st">'DE'</span>,]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>geodataSE <span class="ot">&lt;-</span> geodata[geodata<span class="sc">$</span>CNTR_CODE<span class="sc">==</span><span class="st">'SE'</span>,]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>jut_areas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Sydjylland'</span>, <span class="st">'Vestjylland'</span>, <span class="st">'Nordjylland'</span>, <span class="st">'Østjylland'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>jutland <span class="ot">&lt;-</span> geodataDK[geodataDK<span class="sc">$</span>NUTS_NAME <span class="sc">%in%</span> jut_areas,]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>restofDK <span class="ot">&lt;-</span> geodataDK[<span class="sc">!</span>geodataDK<span class="sc">$</span>NUTS_NAME <span class="sc">%in%</span> jut_areas,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following bit of code then generates the map. The map bits are added individually with <code>geom_sf()</code>, making Jutland yellow, and the rest of Denmark light green, and the other countries light grey. Text annotations are added with <code>annotate()</code>, putting in proper coordinates manually, and <code>xlim()</code> and <code>ylim()</code> are set to include only Denmark (excluding the islands of Bornholm and Christiansø, which are not of interest in this study and which are quite far removed from the rest of the country). <code>theme()</code> options are used to remove most of the regular <code>ggplot()</code> junk which we don’t really need here, and also to turn the background light blue to make it clear what is and what isn’t ocean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mapDK <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>jutland, <span class="at">fill=</span><span class="st">'yellow'</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>restofDK, <span class="at">fill=</span><span class="st">'lightgreen'</span>) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>geodataDE, <span class="at">fill=</span><span class="st">'lightgrey'</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>geodataSE, <span class="at">fill=</span><span class="st">'lightgrey'</span>) <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">'text'</span>, <span class="at">x=</span><span class="fl">8.7</span>, <span class="at">y=</span><span class="fl">57.5</span>, <span class="at">label=</span><span class="st">'Jutland</span><span class="sc">\n</span><span class="st">Danish'</span>, <span class="at">color=</span><span class="st">'orange'</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">fontface=</span><span class="st">'bold'</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">'text'</span>, <span class="at">x=</span><span class="fl">11.7</span>, <span class="at">y=</span><span class="fl">56.4</span>, <span class="at">label=</span><span class="st">'Insular</span><span class="sc">\n</span><span class="st">Danish'</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color=</span><span class="st">'darkgreen'</span>, <span class="at">fontface=</span><span class="st">'bold'</span>, <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">8</span>, <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">54.7</span>, <span class="dv">58</span>) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'lightblue'</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mapDK</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mapDK" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-mapDK-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Map showing the areas associated with the two primary Danish dialect groups.</figcaption>
</figure>
</div>
</div>
</div>
<p>In Modern Standard Danish (MSD), /p t k/ are voiceless aspirated, and /t/ in particular is prominently affricated <span class="citation" data-cites="jespersen1899 fischerjorgensen1954 puggaardrode2022_fosr">(<a href="#ref-jespersen1899" role="doc-biblioref">Jespersen 1899</a>; <a href="#ref-fischerjorgensen1954" role="doc-biblioref">Fischer-Jørgensen 1954</a>; <a href="#ref-puggaardrode2022_fosr" role="doc-biblioref">Puggaard-Rode 2022b</a>)</span>. Until relatively recently, the majority of the Danish speech community spoke traditional dialects <span class="citation" data-cites="kristiansen2003">(<a href="#ref-kristiansen2003" role="doc-biblioref">Kristiansen 2003</a>)</span>, but in the past century, rampant standardization has largely led to the levelling of these varieties <span class="citation" data-cites="pedersen2003">(<a href="#ref-pedersen2003" role="doc-biblioref">Pedersen 2003</a>)</span>. An overt feature of some Jutlandic varieties was the use of a variant of /t/ without salient affrication, which is known colloquially as <em>tørt t</em> ‘dry t’ <span class="citation" data-cites="puggaard2021">(<a href="#ref-puggaard2021" role="doc-biblioref">Puggaard 2021</a>)</span>. There is no consensus about which Jutlandic varieties lacked affrication. Sources have variously claimed that it was missing from all Jutlandic varieties <span class="citation" data-cites="brink1975">(<a href="#ref-brink1975" role="doc-biblioref">Brink &amp; Lund 1975</a>)</span>, Northern Jutlandic <span class="citation" data-cites="petersen2009">(<a href="#ref-petersen2009" role="doc-biblioref">Petersen 2009</a>)</span>, Western Jutlandic <span class="citation" data-cites="petersen2021">(<a href="#ref-petersen2021" role="doc-biblioref">Petersen et al. 2021</a>)</span>, or all varieties except Eastern Jutlandic <span class="citation" data-cites="heger1981">(<a href="#ref-heger1981" role="doc-biblioref">Heger 1981</a>)</span>. We explore this mystery using a large legacy corpus of sociolinguistic interviews which was explicitly recorded to document the traditional language and culture of rural Denmark <span class="citation" data-cites="andersen1981 goldshtein2019">(<a href="#ref-andersen1981" role="doc-biblioref">Andersen 1981</a>; <a href="#ref-goldshtein2019" role="doc-biblioref">Goldshtein &amp; Puggaard 2019</a>)</span>. These recordings (particularly the ones from Jutland) largely preserve a stage of language variation unaffected by the recent wave of standardization.</p>
<p>The acoustics of alveolar frication and aspiration are well-understood. In alveolar frication, a jet of air impinges on a hard surface (the upper front teeth) immediately in front of the coronal constriction, resulting in noise in a broad range of high frequencies (mainly above 4 kHz) <span class="citation" data-cites="stevens1993">(<a href="#ref-stevens1993" role="doc-biblioref">Stevens 1993</a>)</span>. In aspiration, lower frequency turbulence noise in a narrower frequency range (mainly below 1 kHz) is generated at and near the glottis <span class="citation" data-cites="stevens1998">(<a href="#ref-stevens1998" role="doc-biblioref">Stevens 1998</a>)</span>. This noise is filtered through the supraglottal cavity, where the resonance frequencies of the following vowel significantly affect the resulting noise. Analyzing how these spectral characteristics vary regionally is not at all straightforward.</p>
<p>Spectral moments are commonly used to decompose spectra generated from aperiodic portions of speech. The spectral mean, or <em>center of gravity</em> (COG) <span class="citation" data-cites="forrest1988">(<a href="#ref-forrest1988" role="doc-biblioref">Forrest et al. 1988</a>)</span>, is a particularly popular measure. Since spectra rarely resemble Gaussian distributions, the mean frequency alone is not very informative with respect to overall shape; furthermore, studies have found conflicting evidence about which spectral moments (if any) can be used to consistently determine noise sources <span class="citation" data-cites="stoelgammon1994 shadle1996">(<a href="#ref-stoelgammon1994" role="doc-biblioref">Stoel-Gammon, Williams &amp; Buder 1994</a>; <a href="#ref-shadle1996" role="doc-biblioref">Shadle &amp; Mair 1996</a>)</span>. Several other measures have been proposed for decomposing aperiodic spectra <span class="citation" data-cites="jongman2000 bunnell2004 koenig2013">(e.g. <a href="#ref-jongman2000" role="doc-biblioref">Jongman, Wayland &amp; Wong 2000</a>; <a href="#ref-bunnell2004" role="doc-biblioref">Bunnell, Polikoff &amp; McNicholas 2004</a>; <a href="#ref-koenig2013" role="doc-biblioref">Koenig et al. 2013</a>)</span>, but none have been as influential as COG.</p>
<p>For the reasons outlined above, we do not use spectral moments here. Instead, we adopt FPCA as an alternative method. FPCA is used to determine the main sources of variance in curves without imposing predetermined shapes. This makes it particularly suitable for exploratory work. Each resulting principal component PC<sub><em>i</em></sub> corresponds to a source of variance relative to the average spectral shape, and each individual spectrum gets a score <span class="math inline">\(s_i\)</span> for each PC indicating how well it corresponds to this source of variance. These scores can then be fitted to conventional statistical models; here, we fit PC scores to spatial generalized additive mixed models <span class="citation" data-cites="wieling2011">(GAMMs, <a href="#ref-wieling2011" role="doc-biblioref">Wieling, Nerbonne &amp; Baayen 2011</a>)</span> in order to test whether any of the variance in spectral shape is geographically determined. These models also include a range of phonetic contextual predictors. The influence of phonetic contextual predictors largely pattern as predicted, which we take as an indication that FPCA is indeed a suitable tool for decomposing spectra. FPCA has previously been used to analyze various time-varying phonetic measures, such as <em>F</em><sub>0</sub> and formants <span class="citation" data-cites="gubian2011 gubian2015">(<a href="#ref-gubian2011" role="doc-biblioref">Gubian, Boves &amp; Cangemi 2011</a>; <a href="#ref-gubian2015" role="doc-biblioref">Gubian, Torreira &amp; Boves 2015</a>)</span>; to our knowledge, it has not previously been used to analyze speech spectra.</p>
</section>
<section id="methods-and-materials" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods and materials</h1>
<section id="recordings" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="recordings"><span class="header-section-number">2.1</span> Recordings</h2>
<p>Our materials consist of sociolinguistic interviews with elderly speakers of traditional regional varieties recorded between 1971–1976 <span class="citation" data-cites="goldshtein2019 dialektsamlingen">(<a href="#ref-dialektsamlingen" role="doc-biblioref">Dialektsamlingen 1971–1976</a>; <a href="#ref-goldshtein2019" role="doc-biblioref">Goldshtein &amp; Puggaard 2019</a>)</span>. Interviews were conducted with informants in 230 parishes in Jutland, of which 213 were used in this study. 23% of the informants are women. Informants’ median year of birth is 1896 (range 1871–1927). The geographical distribution of informants can be seen in <a href="#fig-locs">Figure&nbsp;2</a> (which shows the location of Djursland for reference.) In spite of the large scope of these recordings, they have not been used for systematic research until very recently <span class="citation" data-cites="puggaard2021 goldshtein2021">(<a href="#ref-goldshtein2021" role="doc-biblioref">Goldshtein &amp; Ahlgren 2021</a>; <a href="#ref-puggaard2021" role="doc-biblioref">Puggaard 2021</a>)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Loading and preprocessing data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Our analysis data is presently spread across four semicolon-separated CSV files, which we’ll load in with <code>read.csv()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/dialect_coordinates.csv'</span>, <span class="at">sep=</span><span class="st">';'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dia_polygon <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/polygons_dialectareas.csv'</span>, <span class="at">sep=</span><span class="st">';'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>participant_info <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/participant_info.csv'</span>, <span class="at">sep=</span><span class="st">';'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>affric <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/affric.csv'</span>, <span class="at">sep=</span><span class="st">';'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s have a quick look at each of these.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(coordinates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 213
Columns: 3
$ parish &lt;chr&gt; "Agerskov", "Als", "Ansager", "Arnborg", "Arup", "Asdal", "Asse…
$ lat    &lt;dbl&gt; 9.129243, 10.287372, 8.755025, 8.990251, 8.922354, 10.028146, 1…
$ long   &lt;dbl&gt; 55.12875, 56.75543, 55.70342, 56.01439, 57.00574, 57.54936, 54.…</code></pre>
</div>
</div>
<p><code>coordinates</code> contains geographical coordinates for each of the parishes included in the study (each parish corresponds to one speaker).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dia_polygon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,192
Columns: 4
$ lat     &lt;dbl&gt; 9.016305, 9.012300, 9.000627, 8.988782, 8.982946, 8.971960, 8.…
$ long    &lt;dbl&gt; 57.15828, 57.15622, 57.15603, 57.15687, 57.15836, 57.15668, 57…
$ order   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…
$ dialect &lt;chr&gt; "NV", "NV", "NV", "NV", "NV", "NV", "NV", "NV", "NV", "NV", "N…</code></pre>
</div>
</div>
<p><code>dia_polygon</code> contains coordinates tracing the traditional dialect areas of Jutland as defined by <span class="citation" data-cites="skautrup1970">Skautrup et al. (<a href="#ref-skautrup1970" role="doc-biblioref">1970–</a>)</span>. These can be plotted in <code>ggplot2</code> with <code>geom_polygon()</code>. The dialect areas are not actually used in this study, but I’ll use these polygons for all maps below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(participant_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 213
Columns: 9
$ X         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
$ parish    &lt;chr&gt; "Åbenrå", "Agerskov", "Ajstrup", "Als", "Ansager", "Arnborg"…
$ parishno  &lt;int&gt; 3191, 3074, 1468, 1541, 2616, 2501, 1568, 1323, 1229, 1211, …
$ tape_id   &lt;int&gt; 943, 395, 979, 353, 1210, 306, 1249, 1055, 461, 988, 39, 303…
$ birthyear &lt;int&gt; 1906, 1883, 1904, 1893, 1895, 1914, 1902, 1904, 1886, 1927, …
$ gender    &lt;chr&gt; "male", "male", "male", "male", "male", "male", "male", "mal…
$ year      &lt;int&gt; 1974, 1972, 1974, 1972, 1975, 1972, 1975, 1975, 1973, 1974, …
$ dialect   &lt;chr&gt; "Søn", "Søn", "N", "NØ", "Sy", "MV", "NØ", "NV", "N", "N", "…
$ rec_age   &lt;int&gt; 68, 89, 70, 79, 80, 58, 73, 71, 87, 47, 78, 81, 79, 69, 74, …</code></pre>
</div>
</div>
<p><code>participant_info</code> contains informant metadata. I’ll briefly go over columns that are not self-explanatory.</p>
<ul>
<li><code>X</code> is simply an identifier containing row numbers.</li>
<li><code>parish</code> is the name of the parish where the informant is from, <code>parishno</code> is a numeric identifier for each parish based on <span class="citation" data-cites="skjelborg1967">Skjelborg (<a href="#ref-skjelborg1967" role="doc-biblioref">1967</a>)</span>.</li>
<li><code>tape_id</code> is an identifier for each original tape. It can be used to locate the recording in the <a href="https://dansklyd.statsbiblioteket.dk/samling/dialektsamlingen/">Royal Danish Library’s dialect collection</a>. The URL for a recording is: <code>dansklyd.statsbiblioteket.dk/lydoptagelse/?eid=Dialekt_P + id</code>; i.e.&nbsp;as can be seen <code>participant_info</code>, the <code>tape_id</code> for the recording from Agerskov is 395, so this recording can be found at <a href="https://dansklyd.statsbiblioteket.dk/lydoptagelse/?eid=Dialekt_P395">dansklyd.statsbiblioteket.dk/lydoptagelse/?eid=Dialekt_P395</a>.</li>
<li><code>birthyear</code> is the birth year of the speaker (if available), <code>year</code> is the year of recording, and <code>rec_age</code> is the age of the speaker at the time of recording. These are not used in the analysis.</li>
<li><code>dialect</code> is the traditional dialect area as defined by <span class="citation" data-cites="skautrup1970">Skautrup et al. (<a href="#ref-skautrup1970" role="doc-biblioref">1970–</a>)</span> which the speaker belongs to.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(affric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 10,447
Columns: 11
$ parish   &lt;chr&gt; "Agerskov", "Agerskov", "Agerskov", "Agerskov", "Agerskov", "…
$ token    &lt;chr&gt; "tæ2", "ty1", "pø2", "te1", "kø1", "te1", "ku1", "koe1", "kø2…
$ cog      &lt;int&gt; 4305, 4157, 1883, 5492, 2713, 6077, 1966, 2959, 2679, 2180, 5…
$ vot      &lt;dbl&gt; 63.3, 46.5, 34.4, 50.3, 66.2, 55.9, 57.6, 61.4, 69.6, 28.2, 8…
$ pal      &lt;chr&gt; "negpal", "negpal", "negpal", "negpal", "negpal", "negpal", "…
$ height   &lt;chr&gt; "mid", "high", "mid", "high", "mid", "high", "high", "low", "…
$ backness &lt;chr&gt; "front", "front", "front", "front", "front", "front", "back",…
$ round    &lt;chr&gt; "negrd", "rd", "rd", "negrd", "rd", "negrd", "rd", "negrd", "…
$ stop     &lt;chr&gt; "t", "t", "p", "t", "k", "t", "k", "k", "k", "p", "t", "k", "…
$ stress   &lt;chr&gt; "str", "negstr", "str", "negstr", "negstr", "negstr", "negstr…
$ .obs     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…</code></pre>
</div>
</div>
<p><code>affric</code> contains information about each token used for the analysis. Note that this data frame has 10,447 and includes not just tokens of /t/ but also tokens of /p k/. The data frame was used for a larger equivalent study of spectral characteristics of stops in Jutland Danish, which can be found in Chapter 6 of <span class="citation" data-cites="puggaardrode2023_diss">Puggaard-Rode (<a href="#ref-puggaardrode2023_diss" role="doc-biblioref">2023</a>)</span>. I’ll briefly go over columns that are not self-explanatory.</p>
<ul>
<li><code>token</code> is a makeshift phonetic transcription of the syllable where the token comes from. These were used to automatically generate the information in the columns mentioned below, following a procedure outlined in the <a href="https://doi.org/10.34894/JHN1Q7">DataverseNL repository</a> accompanying <span class="citation" data-cites="puggaard2021">Puggaard (<a href="#ref-puggaard2021" role="doc-biblioref">2021</a>)</span>.</li>
<li><code>cog</code> contains centre of gravity estimates from <a href="https://fon.hum.uva.nl/praat">Praat</a>. They are not used here.</li>
<li><code>vot</code> contains the voice onset time of each stop token.</li>
<li><code>pal</code>, <code>height</code>, <code>round</code>, <code>stress</code> correspond to the categorical variables <span class="smallcaps">palatalization, height, roundness, stress</span> discussed below. <code>backness</code> contains information about three levels of backness in vowels, which I’ll collapse to two levels below. The values for these are mostly formulated in terms of features – e.g.&nbsp;<code>negpal</code> means “no palatalization” and <code>pal</code> means “palatalization”.</li>
<li><code>.obs</code> is a numeric identifier for each token.</li>
</ul>
<p>I’ll make a data frame <code>df</code> by joining the data frames <code>affric</code>, <code>participant_info</code>, and <code>coordinates</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(affric, participant_info) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coordinates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It was clear from the <code>glimpse()</code>s above that several columns are strings when they should be factors, so we’ll convert those. We’ll also collapse the <code>backness</code> variable into two levels instead of the current three levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">c</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'height'</span>, <span class="st">'round'</span>, <span class="st">'pal'</span>, <span class="st">'stress'</span>, <span class="st">'gender'</span>, <span class="st">'parish'</span>, <span class="st">'backness'</span>)){</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  df[[col]] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df[[col]])</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bkn2l =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    backness <span class="sc">==</span> <span class="st">'front'</span> <span class="sc">|</span> backness <span class="sc">==</span> <span class="st">'central'</span> <span class="sc">~</span> <span class="st">'nbk'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'bk'</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bkn2l =</span> <span class="fu">as.factor</span>(bkn2l))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Generating the map in <a href="#fig-locs">Figure&nbsp;2</a>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="#fig-locs">Figure&nbsp;2</a> is generated in <code>ggplot2</code> by plotting green dots for each of the coordinates in the <code>coordinates</code> data frame on top of the outlines of Jutland dialect areas in the <code>dia_polygon</code> data frame. I also use <code>geom_segment()</code> and <code>annotate()</code> to indicate the location of Djursland on the map. <code>theme()</code> is used to remove all the regular <code>ggplot</code> junk so we just have a blank background and no axes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>locs_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coordinates) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>lat, <span class="at">y=</span>long) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>dia_polygon, <span class="fu">aes</span>(<span class="at">x=</span>lat, <span class="at">y=</span>long, <span class="at">group=</span>dialect),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color=</span><span class="st">'grey'</span>, <span class="at">lwd=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.7</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">2.5</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="st">'darkgreen'</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x=</span><span class="fl">10.4</span>, <span class="at">y=</span><span class="fl">55.6</span>, <span class="at">xend=</span><span class="fl">10.7</span>, <span class="at">yend=</span><span class="fl">56.1</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow=</span><span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">'npc'</span>)), <span class="at">linewidth=</span><span class="fl">1.2</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">lineend=</span><span class="st">'butt'</span>, <span class="at">linejoin=</span><span class="st">'round'</span>, <span class="at">col=</span><span class="st">'darkgreen'</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">label=</span><span class="st">'Djursland'</span>, <span class="at">x=</span><span class="fl">10.4</span>, <span class="at">y=</span><span class="fl">55.5</span>, <span class="at">col=</span><span class="st">'darkgreen'</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="st">"#FFFFFF"</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.text =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>locs_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-locs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-locs-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The geographical distribution of recordings used in this study.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="acoustic-processing" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="acoustic-processing"><span class="header-section-number">2.2</span> Acoustic processing</h2>
<p>5,169 /t/ releases were manually segmented. The release burst and the onset of periodicity were used as delimitation landmarks, as identified from the waveform. Using Praat <span class="citation" data-cites="boersma2021">(<a href="#ref-boersma2021" role="doc-biblioref">Boersma &amp; Weenink 2021</a>)</span>, 5 ms snippets were extracted from the midpoint of each /t/ release, filtered to include only frequencies between 0.5–12.5 kHz. For each of these, multitaper spectra were generated in R <span class="citation" data-cites="r2022">(<a href="#ref-r2022" role="doc-biblioref">R Core Team 2022</a>)</span> following the method described in <span class="citation" data-cites="reidy2013">(<a href="#ref-reidy2013" role="doc-biblioref">Reidy 2013</a>)</span>. Intensity values were log-transformed and standardized in order to keep all spectra on the same scale. Measurements at frequencies &gt; 8 kHz were not included in the analysis, as they did not contribute much to the analysis other than noise.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Generating multitaper spectra
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here I’ll show how multitaper spectra were generated using two examples – a relatively non-affricated /t/ token spoken by an <a href="https://dansklyd.statsbiblioteket.dk/lydoptagelse/?eid=Dialekt_P1210">informant from Ansager</a> and a relatively affricated token spoken by an <a href="https://dansklyd.statsbiblioteket.dk/lydoptagelse/?eid=Dialekt_P39">informant from Asserballeskov</a>.</p>
<p>First I’ll load in two WAV files as R objects containing brief sound snippets using the <code>snd.read()</code> function from <code>rPraat</code>. I store the beginning and end times of the stop releases in the vectors <code>aff_loc</code> and <code>asp_loc</code>. I then use the base R plotting function to plot and annotate waveforms. Amplitude measures – which correspond to the audio signal – are stored as <code>$sig</code> in the R objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rPraat)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>aff <span class="ot">&lt;-</span> <span class="fu">snd.read</span>(<span class="st">'snd/aff.wav'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>aff_loc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.111</span>, <span class="fl">0.168</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>mid_aff <span class="ot">&lt;-</span> <span class="fu">min</span>(aff_loc) <span class="sc">+</span> (<span class="fu">diff</span>(aff_loc)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>asp <span class="ot">&lt;-</span> <span class="fu">snd.read</span>(<span class="st">'snd/asp.wav'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>asp_loc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.108</span>, <span class="fl">0.158</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>mid_asp <span class="ot">&lt;-</span> <span class="fu">min</span>(asp_loc) <span class="sc">+</span> (<span class="fu">diff</span>(asp_loc)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aff<span class="sc">$</span>t, aff<span class="sc">$</span>sig[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'red'</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Time (s)'</span>, <span class="at">ylab=</span><span class="st">'Energy (dB)'</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.21</span>, <span class="fl">0.3</span>))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>aff_loc, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.05</span>, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">labels=</span><span class="st">'a'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>mid_aff, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">labels=</span><span class="st">'t'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.207</span>, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">labels=</span><span class="st">'i'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(asp<span class="sc">$</span>t, asp<span class="sc">$</span>sig[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'blue'</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Time (s)'</span>, <span class="at">ylab=</span><span class="st">'Energy (dB)'</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.27</span>, <span class="fl">0.2</span>))</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>asp_loc, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.03</span>, <span class="at">y=</span><span class="fl">0.18</span>, <span class="at">labels=</span><span class="st">'ə'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>mid_asp, <span class="at">y=</span><span class="fl">0.18</span>, <span class="at">labels=</span><span class="st">'t'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.2</span>, <span class="at">y=</span><span class="fl">0.18</span>, <span class="at">labels=</span><span class="st">'œ'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">font=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>Since multitaper spectra were generated from 5 ms snippet at each release midpoint, these are equivalent plots showing just those 5 ms snippets.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aff<span class="sc">$</span>t, aff<span class="sc">$</span>sig[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'red'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Time (s)'</span>, <span class="at">ylab=</span><span class="st">'Energy (dB)'</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.21</span>, <span class="fl">0.3</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(mid_aff<span class="fl">-0.0025</span>, mid_aff<span class="fl">+0.0025</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.05</span>, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">labels=</span><span class="st">'a'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>mid_aff, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">labels=</span><span class="st">'t'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.207</span>, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">labels=</span><span class="st">'i'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(asp<span class="sc">$</span>t, asp<span class="sc">$</span>sig[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'blue'</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Time (s)'</span>, <span class="at">ylab=</span><span class="st">'Energy (dB)'</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.27</span>, <span class="fl">0.2</span>))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(mid_asp<span class="fl">-0.0025</span>, mid_asp<span class="fl">+0.0025</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.03</span>, <span class="at">y=</span><span class="fl">0.18</span>, <span class="at">labels=</span><span class="st">'ə'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>mid_asp, <span class="at">y=</span><span class="fl">0.18</span>, <span class="at">labels=</span><span class="st">'t'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">0.2</span>, <span class="at">y=</span><span class="fl">0.18</span>, <span class="at">labels=</span><span class="st">'œ'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">font=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>In order to get a better feel for the difference between multitaper spectra and the more commonly used fast Fourier transformed (FFT) spectra, I’ll first generate and visualize equivalent FFT spectral slices. I load in the relevant 5 ms snippets using <code>snd.read()</code>. The snippets are downsampled to 25 kHz using the function <code>resamp()</code> from the <code>seewave</code> package, which takes as arguments a vector corresponding to the sound signal, the original sample rate <code>f</code> and the desired sample rate <code>g</code>. I generate FFT spectral slices using the function <code>spectralslice()</code> from the <code>phonTools</code> package, which takes as arguments the signal and sample rate <code>fs</code>. <code>spectralslice()</code> plots the spectrum by default; I set <code>show=FALSE</code> to suppress this and plot the results myself (so I can add color, set flexible axis limits, etc).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seewave)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phonTools)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>aff_mid <span class="ot">&lt;-</span> <span class="fu">snd.read</span>(<span class="st">'snd/aff.wav'</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">from=</span>mid_aff<span class="fl">-0.0025</span>, <span class="at">to=</span>mid_aff<span class="fl">+0.0025</span>, <span class="at">units=</span><span class="st">'seconds'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>sr <span class="ot">&lt;-</span> <span class="dv">25000</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>aff_mid_25kHz <span class="ot">&lt;-</span> <span class="fu">resamp</span>(aff_mid<span class="sc">$</span>sig, <span class="at">f=</span>aff_mid<span class="sc">$</span>fs, <span class="at">g=</span>sr)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>fft <span class="ot">&lt;-</span> <span class="fu">spectralslice</span>(aff_mid_25kHz[,<span class="dv">1</span>], <span class="at">fs=</span>sr, <span class="at">show=</span>F)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fft[,<span class="dv">1</span>], fft[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">'Frequency (Hz)'</span>, <span class="at">ylab=</span><span class="st">'Power (dB)'</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">4000</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">'dashed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>asp_mid <span class="ot">&lt;-</span> <span class="fu">snd.read</span>(<span class="st">'snd/asp.wav'</span>, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">from=</span>mid_asp<span class="fl">-0.0025</span>, <span class="at">to=</span>mid_asp<span class="fl">+0.0025</span>, <span class="at">units=</span><span class="st">'seconds'</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>asp_mid_25kHz <span class="ot">&lt;-</span> <span class="fu">resamp</span>(asp_mid<span class="sc">$</span>sig, <span class="at">f=</span>asp_mid<span class="sc">$</span>fs, <span class="at">g=</span>sr)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fft <span class="ot">&lt;-</span> <span class="fu">spectralslice</span>(asp_mid_25kHz[,<span class="dv">1</span>], <span class="at">fs=</span>sr, <span class="at">show=</span>F)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fft[,<span class="dv">1</span>], fft[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">'Frequency (Hz)'</span>, <span class="at">ylab=</span><span class="st">'Power (dB)'</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">4000</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">'dashed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Multitaper spectra are generated using the <code>spec.mtm()</code> function from the <code>multitaper</code> package, which takes as arguments a signal, a frequency bandwidth parameter <code>nw</code>, the number of eigenspectra used to compute the spectrum <code>k</code>, and <code>deltat</code> containing the time difference between adjacent samples in the signal, i.e.&nbsp;1 divided by our sample rate. I set <code>nw=4</code> and <code>k=8</code> (i.e.&nbsp;<span class="math inline">\(K = 2nW\)</span>) following the suggestions by <span class="citation" data-cites="reidy2013">Reidy (<a href="#ref-reidy2013" role="doc-biblioref">2013</a>)</span>. <code>spec.mtm()</code> also plots the resulting spectrum by default, which I once again suppress with <code>plot=FALSE</code>.</p>
<p>In the resulting object, energy is in the <span class="math inline">\(W/m^2\)</span> scale rather than the more familiar decibel scale. In order to achieve a spectrum in a standardized decibel-equivalent scale, I log-transform and subsequently standardize the spectrum object. The results are plotted using the base R plotting function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multitaper)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mts <span class="ot">&lt;-</span> <span class="fu">spec.mtm</span>(aff_mid_25kHz, <span class="at">nw=</span><span class="dv">4</span>, <span class="at">k=</span><span class="dv">8</span>, <span class="at">deltat=</span><span class="dv">1</span><span class="sc">/</span>sr, <span class="at">plot=</span>F)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>mts_log <span class="ot">&lt;-</span> <span class="fu">log</span>(mts<span class="sc">$</span>spec)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>mts_std <span class="ot">&lt;-</span> (mts_log <span class="sc">-</span> <span class="fu">mean</span>(mts_log)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(mts_log))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mts<span class="sc">$</span>freq, mts_std, <span class="at">xlab=</span><span class="st">'Frequency (Hz)'</span>, <span class="at">ylab=</span><span class="st">'Power (std.)'</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">4000</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">'dashed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mts <span class="ot">&lt;-</span> <span class="fu">spec.mtm</span>(asp_mid_25kHz, <span class="at">nw=</span><span class="dv">4</span>, <span class="at">k=</span><span class="dv">8</span>, <span class="at">deltat=</span><span class="dv">1</span><span class="sc">/</span>sr, <span class="at">plot=</span>F)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mts_log <span class="ot">&lt;-</span> <span class="fu">log</span>(mts<span class="sc">$</span>spec)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>mts_std <span class="ot">&lt;-</span> (mts_log <span class="sc">-</span> <span class="fu">mean</span>(mts_log)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(mts_log))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mts<span class="sc">$</span>freq, mts_std, <span class="at">xlab=</span><span class="st">'Frequency (Hz)'</span>, <span class="at">ylab=</span><span class="st">'Power (std.)'</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">'l'</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">4000</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">'dashed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>When I originally did this study, I used a Praat script <span class="citation" data-cites="disscode">(available in <a href="#ref-disscode" role="doc-biblioref">Puggaard-Rode 2022a</a>)</span> to extract 5 ms snippets and subsequently generated multitaper spectra in R. These are stored in a CSV file which we’ll load in as <code>spectra</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/yind_log.csv'</span>, <span class="at">sep=</span><span class="st">','</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(spectra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 637,206
Columns: 3
$ .obs   &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ .index &lt;dbl&gt; 200.0000, 400.8333, 601.6667, 802.5000, 1003.3333, 1204.1667, 1…
$ .value &lt;dbl&gt; -0.72130994, -0.78466663, -0.60640837, -0.55430433, -0.48678129…</code></pre>
</div>
</div>
<p>This (rather large!) data frame has three columns:</p>
<ul>
<li><code>.obs</code> containing a unique numeric identifier for each spectrum.</li>
<li><code>.index</code> containing frequency bins.</li>
<li><code>.value</code> containing standardized energy values by frequency bin.</li>
</ul>
<p>I generated the spectra using a bundle of convenience functions written by Patrick Reidy called <a href="https://github.com/patrickreidy/spectRum"><code>spectRum</code></a>, which I’ve since moved away from in favor of using the <code>multitaper</code> package. If I had done this study now, I would’ve done it in one fell swoop in R. The annotated code below shows how this particular task could’ve been done more efficiently, but for the rest of the exposition I’ll be using the spectra originally generated in 2022. If you’re interested in adapting the code below but aren’t sure how, feel free to reach out!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>textgrids <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern=</span><span class="st">'*.TextGrid'</span>) </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>basenames <span class="ot">&lt;-</span> <span class="fu">unlist</span>(   <span class="co">#get list of file names without extension</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split</span>(textgrids, <span class="at">pattern=</span><span class="st">'[.]'</span>))[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(textgrids)<span class="sc">*</span><span class="dv">2</span>, <span class="dv">2</span>)]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">0</span>   <span class="co">#generic counter</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">parish =</span> <span class="cn">NULL</span>, <span class="at">.obs =</span> <span class="cn">NULL</span>,   <span class="co">#empty data frame</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.index =</span> <span class="cn">NULL</span>, <span class="at">.value =</span> <span class="cn">NULL</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> basenames) {   <span class="co">#loop over all files</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  tg <span class="ot">&lt;-</span> <span class="fu">tg.read</span>(<span class="fu">paste0</span>(i, <span class="st">'.TextGrid'</span>))   <span class="co">#read in ith TextGrid</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  t_int <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">str_sub</span>(tg<span class="sc">$</span>possg<span class="sc">$</span>label, <span class="at">end=</span><span class="dv">1</span>) <span class="sc">==</span> <span class="st">'t'</span>)   <span class="co">#get all intervals</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#where the label starts with 't', which in this case is stop releases. </span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#depends on the tier names in the TextGrid,</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#this only works because the TGs all have a tier named possg</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> tg<span class="sc">$</span>possg<span class="sc">$</span>t1[t_int]   <span class="co">#interval start times are stored in $t1</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  end <span class="ot">&lt;-</span> tg<span class="sc">$</span>possg<span class="sc">$</span>t2[t_int]    <span class="co">#end times stored in $t2</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  mid <span class="ot">&lt;-</span> start <span class="sc">+</span> (end<span class="sc">-</span>start)<span class="sc">/</span><span class="dv">2</span>   <span class="co">#compute mid times</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(t_int)) {   <span class="co">#loop over intervals starting with t</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z <span class="sc">+</span> <span class="dv">1</span>   <span class="co">#increase counter</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    snd <span class="ot">&lt;-</span> <span class="fu">snd.read</span>(<span class="fu">paste0</span>(i, <span class="st">'.wav'</span>),   <span class="co">#read 5 ms from sound file</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">from=</span>mid[j] <span class="sc">-</span> <span class="fl">0.0025</span>,</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">to=</span>mid[j] <span class="sc">+</span> <span class="fl">0.0025</span>,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">units=</span><span class="st">'seconds'</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    sig_mono <span class="ot">&lt;-</span> (snd<span class="sc">$</span>sig[,<span class="dv">1</span>] <span class="sc">+</span> snd<span class="sc">$</span>sig[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>   <span class="co">#convert stereo signal to mono</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    sig_25kHz <span class="ot">&lt;-</span> <span class="fu">resamp</span>(sig_mono, <span class="at">f=</span>snd<span class="sc">$</span>fs, <span class="at">g=</span><span class="dv">25000</span>)   <span class="co">#downsample to 25kHz</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    mts <span class="ot">&lt;-</span> <span class="fu">spec.mtm</span>(sig_25kHz, <span class="at">nw=</span><span class="dv">4</span>, <span class="at">k=</span><span class="dv">8</span>,    <span class="co">#generate multitaper spectrum</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">deltat=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">25000</span>, <span class="at">plot=</span>F)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    mts_log <span class="ot">&lt;-</span> <span class="fu">log</span>(mts<span class="sc">$</span>spec)   <span class="co">#log transform to get dB-equivalent scale</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    mts_std <span class="ot">&lt;-</span> (mts_log <span class="sc">-</span> <span class="fu">mean</span>(mts_log)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(mts_log))   <span class="co">#stanardize</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    spectra <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(   <span class="co">#make data frame called spectra with...</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">parish =</span> <span class="fu">rep</span>(i, <span class="fu">length</span>(mts_std)),   <span class="co">#name of the parish</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">.obs =</span> <span class="fu">rep</span>(z, <span class="fu">length</span>(mts_std)),   <span class="co">#unique identifier</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">.index =</span> mts<span class="sc">$</span>freq,   <span class="co">#frequency bin from mts object</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">.value =</span> mts_std) <span class="sc">%&gt;%</span>   <span class="co">#standardized energy value</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rbind</span>(spectra)   <span class="co">#...which we combine with the existing spectra df</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>All statistics were calculated in R <span class="citation" data-cites="r2022">(<a href="#ref-r2022" role="doc-biblioref">R Core Team 2022</a>)</span>. The package <code>fdapace</code> <span class="citation" data-cites="fdapace">(<a href="#ref-fdapace" role="doc-biblioref">Zhou et al. 2022</a>)</span> was used for FPCA. Spectra were smoothed using a local linear smoother with parameters set automatically using generalized cross-validation. Five PCs are needed to account for 95% of spectral variance. We focus on the first three PC<sub>1–3</sub>, which account for 85.9% of the variance.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Running functional PCA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Before we can proceed to running functional PCA a little data manipulation is needed, because right now we just have a data frame <code>df</code> with information about tokens of /p t k/ and another data frame with spectra, also from stop releases of all places of articulation. We need to separate out the /t/s in a new data frame with a new numeric identifier. I also remove the frequencies between 500–8000 Hz at this stage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stop<span class="sc">==</span><span class="st">'t'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_id =</span> <span class="fu">seq.int</span>(<span class="fu">nrow</span>(<span class="fu">filter</span>(df, stop<span class="sc">==</span><span class="st">'t'</span>))))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>t_spectra <span class="ot">&lt;-</span> t_df <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(spectra) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.index <span class="sc">&gt;</span> <span class="dv">500</span> <span class="sc">&amp;</span> .index <span class="sc">&lt;</span> <span class="dv">8000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(new_id, .index, .value) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">.obs =</span> new_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Functional PCA is implemented with the <code>fdapace</code> package. There are several packages in R that can do FPCA – <code>fdapace</code> is the one I know best, it’s quite flexible and is arguably a lot more user-friendly and stable these days than the well-known <code>fda</code> package.</p>
<p>We first use the function <code>MakeFPCAInputs()</code> to create an object with the right structure. This function takes as arguments three numeric vectors of the same size, corresponding to the three columns in our <code>t_spectra</code> data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>t_input <span class="ot">&lt;-</span> <span class="fu">MakeFPCAInputs</span>(<span class="at">IDs =</span> t_spectra<span class="sc">$</span>.obs, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tVec =</span> t_spectra<span class="sc">$</span>.index, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">yVec =</span> t_spectra<span class="sc">$</span>.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting object contains the lists <code>Ly</code> and <code>Lt</code> with the index and values, respectively. The actual analysis is done with the <code>FPCA()</code> function, which takes the arguments <code>Ly</code> and <code>Lt</code>. We also pass a list of further arguments, specifying that the results should be plotted, that the spectra should be smoothed <code>methodMuCovEst = 'smooth'</code> with parameters estimated using generalized cross-validation <code>methodBwCov = 'GCV'</code>. The data are dense, so the default is not to do any smoothing, but since the spectra are quite noisy, results are better when the spectra are smoothed. We also set a ‘fraction of variance explained’ threshold of 95% <code>FVEthreshold = 0.95</code> – enough principal components should be estimated to explain 95% of variance in the data. There’s a <a href="https://cran.r-project.org/web/packages/fdapace/vignettes/fdapaceVig.html">nice vignette</a> explaining the options of the package in more detail.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fpca_t <span class="ot">&lt;-</span> <span class="fu">FPCA</span>(t_input<span class="sc">$</span>Ly, t_input<span class="sc">$</span>Lt,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">list</span>(<span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">methodMuCovEst =</span> <span class="st">'smooth'</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">methodBwCov =</span> <span class="st">'GCV'</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FVEthreshold =</span> <span class="fl">0.95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Some nice visualizations are returned which summarize the fit. The design plot confirms that the data are dense, i.e.&nbsp;that the spacing of measurements across the frequency grid (‘time grid’) is fully predictable. The scree plot shows that we need five PCs to explain 95% of variance, and that the first PC in particular explains more than half of the variance. We also see the estimated mean spectrum (‘mean function’), and the shapes of the three first PCs are visualized (‘First 3 Eigenfunctions’).</p>
<p><code>FCPA()</code> returns a list with a lot of information about the fit. The scores <span class="math inline">\(s_i\)</span> are stored in the matrix <code>$xiEst</code>. We take the first three columns of that matrix and store them in <code>t_df</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> t_df <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fpc1 =</span> fpca_t<span class="sc">$</span>xiEst[,<span class="dv">1</span>],</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fcp2 =</span> fpca_t<span class="sc">$</span>xiEst[,<span class="dv">2</span>],</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fpc3 =</span> fpca_t<span class="sc">$</span>xiEst[,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>PC scores <span class="math inline">\(s_{1-3}\)</span> served as dependent variables in separate GAMMs with the following maximal structure: <span class="math inline">\(s_i\)</span> ~ <span class="smallcaps">lon,lat + height + stress + sex + back + round + palatalization + vot</span>. (<span class="smallcaps">height, round, back,</span> and <span class="smallcaps">stress</span> refer to features of the following vowel; <span class="smallcaps">sex</span> refers to the sex of the speaker.) Most of these features have been shown to affect spectral shape in MSD stop releases <span class="citation" data-cites="puggaardrode2022_fosr">(<a href="#ref-puggaardrode2022_fosr" role="doc-biblioref">Puggaard-Rode 2022b</a>)</span>. There were various phonological palatalization rules in different Jutland Danish varieties <span class="citation" data-cites="bennike1898">(<a href="#ref-bennike1898" role="doc-biblioref">Bennike &amp; Kristensen 1898–1912</a>)</span>; we make no distinction between different sources of palatalization. All categorical variables are contrast coded <span class="citation" data-cites="schad2020">(<a href="#ref-schad2020" role="doc-biblioref">Schad et al. 2020</a>)</span>; the <span class="smallcaps">height</span> variable tests two Helmert contrasts, viz.&nbsp;‘high <em>vs.</em> non-high’ and ‘low <em>vs.</em> mid’. All other categorical variables are binary and coded with sum contrasts. The <span class="smallcaps">vot</span> variable is standardized. By-speaker random slopes were included for each variable except <span class="smallcaps">sex</span>. The geographical variable <span class="smallcaps">lon,lat</span> is modelled with two-dimensional thin plate regression spline smooths <span class="citation" data-cites="wood2003">(<a href="#ref-wood2003" role="doc-biblioref">Wood 2003</a>)</span>. GAMMs were fitted using the package <code>mgcv</code> <span class="citation" data-cites="wood2022">(<a href="#ref-wood2022" role="doc-biblioref">Wood 2022</a>)</span>. The packages <code>itsadug</code> <span class="citation" data-cites="itsadug">(<a href="#ref-itsadug" role="doc-biblioref">van Rij et al. 2022</a>)</span> and <code>mgcViz</code> <span class="citation" data-cites="fasiolo2020">(<a href="#ref-fasiolo2020" role="doc-biblioref">Fasiolo et al. 2020</a>)</span> were used for health checks and visualizations of the models.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Coding contrasts
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By default, categorical variables in R are coded with treatment contrasts. We can check this with the function <code>contrasts()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>round)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      rd
negrd  0
rd     1</code></pre>
</div>
</div>
<p>We get the same matrix if we run <code>contr.treatment()</code> to get treatment contrasts for a variable with 2 levels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contr.treatment</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  2
1 0
2 1</code></pre>
</div>
</div>
<p>We can override this default by simply assigning another matrix of the right size to <code>contrasts(t_df$round)</code>. We could generate this matrix with <code>contr.sum()</code>, but sometimes it’s nicer to generate them by hand – then you are free to name your contrasts and to order them in a way that matches your theory.</p>
<p>I set sum contrasts for the <code>round</code> variable like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">+</span><span class="fl">0.5</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast) <span class="ot">&lt;-</span> <span class="st">"-nrd+rd"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>round) <span class="ot">&lt;-</span> contrast</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>round)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      -nrd+rd
negrd    -0.5
rd        0.5</code></pre>
</div>
</div>
<p>This matrix is <em>not</em> identical to the output of <code>contr.sum()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contr.sum</span>(<span class="at">n=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [,1]
1    1
2   -1</code></pre>
</div>
</div>
<p>But it’s similar in all the important ways (the contrasts are orthogonal and zero-centered). I’ll reuse this matrix for the other binary variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast) <span class="ot">&lt;-</span> <span class="st">"-bk+nbk"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>bkn2l) <span class="ot">&lt;-</span> contrast</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast) <span class="ot">&lt;-</span> <span class="st">"-npl+pl"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>pal) <span class="ot">&lt;-</span> contrast</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast) <span class="ot">&lt;-</span> <span class="st">"-nst+st"</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>stress) <span class="ot">&lt;-</span> contrast</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast) <span class="ot">&lt;-</span> <span class="st">"-f+m"</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>gender) <span class="ot">&lt;-</span> contrast</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We set Helmert contrasts for the three-level variable <span class="smallcaps">height</span>. This procedure is similar, but requires a 3x2 matrix instead of a 2x1 matrix. This should be functionally equivalent to the output of <code>contr.helmert(n=3)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="sc">+</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">+</span><span class="fl">0.5</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"-ml+h"</span>, <span class="st">"-l+m"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(t_df<span class="sc">$</span>height) <span class="ot">&lt;-</span> contrast</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The source material is spontaneous speech, so the data are rather imbalanced: 41.9% of /t/ tokens were followed by non-high vowels, of which 15.5% were low. 34% of tokens were found in stressed syllables. 11.6% of tokens were followed by back vowels, and 22.9% were followed by rounded vowels. Only 2.5% of the tokens were palatalized.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Imbalances in the data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>height_prop <span class="ot">&lt;-</span> <span class="fu">table</span>(t_df<span class="sc">$</span>height) <span class="sc">/</span> <span class="fu">nrow</span>(t_df)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>str_prop <span class="ot">&lt;-</span> <span class="fu">table</span>(t_df<span class="sc">$</span>stress) <span class="sc">/</span> <span class="fu">nrow</span>(t_df)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>bk_prop <span class="ot">&lt;-</span> <span class="fu">table</span>(t_df<span class="sc">$</span>bkn2l) <span class="sc">/</span> <span class="fu">nrow</span>(t_df)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>rd_prop <span class="ot">&lt;-</span> <span class="fu">table</span>(t_df<span class="sc">$</span>round) <span class="sc">/</span> <span class="fu">nrow</span>(t_df)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>pal_prop <span class="ot">&lt;-</span> <span class="fu">table</span>(t_df<span class="sc">$</span>pal) <span class="sc">/</span> <span class="fu">nrow</span>(t_df)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>props <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Level =</span> <span class="fu">c</span>(<span class="st">'High'</span>, <span class="st">'Low'</span>, <span class="st">'Mid'</span>, <span class="st">'Unstressed'</span>, <span class="st">'Stressed'</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Back'</span>, <span class="st">'Non-back'</span>, <span class="st">'Unrounded'</span>, <span class="st">'Rounded'</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Non-palatalized'</span>, <span class="st">'Palatalized'</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="fu">c</span>(</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    height_prop, str_prop, bk_prop, rd_prop, pal_prop</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">'%'</span>))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(props) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>props</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">High</td>
<td style="text-align: left;">58.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Low</td>
<td style="text-align: left;">15.5%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mid</td>
<td style="text-align: left;">26.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unstressed</td>
<td style="text-align: left;">66%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stressed</td>
<td style="text-align: left;">34%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Back</td>
<td style="text-align: left;">11.6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Non-back</td>
<td style="text-align: left;">88.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unrounded</td>
<td style="text-align: left;">77.1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rounded</td>
<td style="text-align: left;">22.9%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Non-palatalized</td>
<td style="text-align: left;">97.5%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Palatalized</td>
<td style="text-align: left;">2.5%</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>We used a step-up model selection procedure, adding variables in the order given above <span class="citation" data-cites="puggaardrode2022_fosr">(based on these variables’ influence on MSD /t/ release spectra, <a href="#ref-puggaardrode2022_fosr" role="doc-biblioref">Puggaard-Rode 2022b</a>)</span>. Variables were only kept if the cost of fitting a more complex model was sufficiently outweighed by an improved model fit, as determined with likelihood ratio tests <span class="citation" data-cites="vanrij2016">(<a href="#ref-vanrij2016" role="doc-biblioref">van Rij 2016</a>)</span>. Data and annotated analysis code are available online <span class="citation" data-cites="disscode">(<a href="#ref-disscode" role="doc-biblioref">Puggaard-Rode 2022a</a>)</span>. More details of the study are available in my dissertation <span class="citation" data-cites="puggaardrode2023_diss">(<a href="#ref-puggaardrode2023_diss" role="doc-biblioref">Puggaard-Rode 2023</a>)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fitting GAMMs
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here, I simply show the code used to fit the GAMMs that are actually reported in the paper, i.e.&nbsp;I do not go over the model selection procedure or likelihood ratio testing. This is covered in more detail in <span class="citation" data-cites="disscode">Puggaard-Rode (<a href="#ref-disscode" role="doc-biblioref">2022a</a>)</span>. This decision is in large part because my <em>ICPhS</em> presentation focuses on other ways of determining the magnitude of the geographical effect in particular. Rather than becoming bogged down with the best way of determining a global <span class="math inline">\(p\)</span>-value for smooth effects, I want to focus more on where on the grid the smooth effect is particularly stable and where it isn’t.</p>
<p>Models are fitted with the <code>bam()</code> function for large GAMMs from the <code>mgcv</code> package. A separate model with a unique structure is fitted for each of the three most influential PCs. The syntax for the parametric part of the model is similar to linear models fitted with <code>lm()</code> or <code>lmer()</code>. The geographical effect is a two-dimensional smooth term <code>s(lat,long)</code>, which use the thin plate regression spline basis as default (equivalent to specifying <code>bs='tp'</code>). Random intercepts and slopes are also fitted using the <code>s()</code> syntax for smooth terms, specifying <code>bs='re'</code> as the ‘smoothing basis’. <code>discrete=TRUE</code> tells <code>bam()</code> to use discretized values for covariates, which should not have a major impact on the results but which will greatly speed up the process. A standardized VOT variable <code>st_vot</code> is created on the fly when necessary. <code>nthreads=10</code> tells <code>bam()</code> to do parallel computation using 10 cores; if available, assigning a suitable number of cores can greatly speed up the process. <code>control=list(trace=TRUE))</code> will print some messages in the console as the model is running so it’s easier to keep track of the progress.</p>
<p>Note that only the <span class="math inline">\(s_1\)</span> model actually has a non-linear component, so the <span class="math inline">\(s_{2-3}\)</span> models could’ve just as easily been fitted with e.g.&nbsp;<code>lmer()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>gam_pc1 <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">bam</span>(fpc1 <span class="sc">~</span> height <span class="sc">+</span> gender <span class="sc">+</span> bkn2l <span class="sc">+</span> round <span class="sc">+</span> pal <span class="sc">+</span> st_vot <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(lat,long) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>st_vot, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>height, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>round, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>bkn2l, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>pal, <span class="at">bs=</span><span class="st">'re'</span>), </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> t_df <span class="sc">%&gt;%</span> </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">st_vot =</span> (vot <span class="sc">-</span> <span class="fu">mean</span>(vot)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(vot))), </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discrete=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nthreads=</span><span class="dv">10</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">control=</span><span class="fu">list</span>(<span class="at">trace=</span><span class="cn">TRUE</span>))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>gam_pc2 <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">bam</span>(fcp2 <span class="sc">~</span> height <span class="sc">+</span> stress <span class="sc">+</span> bkn2l <span class="sc">+</span> round <span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>height, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>round, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>stress, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>bkn2l, <span class="at">bs=</span><span class="st">'re'</span>), </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> t_df,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discrete=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nthreads=</span><span class="dv">10</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">control=</span><span class="fu">list</span>(<span class="at">trace=</span><span class="cn">TRUE</span>))</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>gam_pc3 <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">bam</span>(fpc3 <span class="sc">~</span> height <span class="sc">+</span> stress <span class="sc">+</span> gender <span class="sc">+</span> </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                       bkn2l <span class="sc">+</span> round <span class="sc">+</span> pal <span class="sc">+</span> st_vot <span class="sc">+</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>st_vot, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>height, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>round, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>stress, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>bkn2l, <span class="at">bs=</span><span class="st">'re'</span>) <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">s</span>(parish, <span class="at">by=</span>pal, <span class="at">bs=</span><span class="st">'re'</span>), </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> t_df <span class="sc">%&gt;%</span> </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">st_vot =</span> (vot <span class="sc">-</span> <span class="fu">mean</span>(vot)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(vot))), </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">discrete=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nthreads=</span><span class="dv">10</span>,</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">control=</span><span class="fu">list</span>(<span class="at">trace=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The models were fitted on the Linux server available at the IPS. I’ll simply load them in here. I load them in for the purpose of this document, but you won’t find the models on GitHub because the files are too large to store there. You should get the same results if you rerun the GAMMs (although it takes a while), or simply reach out if you want to look at exactly these model objects and I’ll figure out a way to share them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">'mods/gam_pc1.Rda'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">'mods/gam_pc2.Rda'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">'mods/gam_pc3.Rda'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Residual plots
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a convenience function for making plots showing the distribution of the models’ residuals – one plot comparing the distribution to a Gaussian distribution with the same mean and standard deviation, and a QQ plot. This function should be general enough for work with any GAMM fitted with <code>mgcv</code>. (You get roughly equivalent but undeniably uglier plots with the <code>mgcv</code> function <code>gam.check()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>resid_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  resid <span class="ot">&lt;-</span> mod[[<span class="st">'residuals'</span>]]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mean</span>(resid)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sd</span>(resid)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  normdist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(resid)) <span class="sc">+</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>resid) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">bins=</span><span class="dv">24</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun=</span>dnorm,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span>m, <span class="at">sd=</span>s),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span><span class="st">'orange'</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">'Comparison with normal distribution'</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">'Residuals'</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  qqpl <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">sample=</span>resid) <span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_qq_line</span>(<span class="at">color=</span><span class="st">'orange'</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">'QQ plot'</span>) <span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">'Theoretical quantiles'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Samples'</span>)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(normdist, qqpl, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>gam_pc1 <span class="sc">%&gt;%</span> resid_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>The residuals from the <span class="math inline">\(s_1\)</span> model are reasonably normally distributed.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>gam_pc2 <span class="sc">%&gt;%</span> resid_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>The residuals from the <span class="math inline">\(s_2\)</span> model are quite left skewed.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>gam_pc3 <span class="sc">%&gt;%</span> resid_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<p>There’s also some left skew to the residuals from the <span class="math inline">\(s_3\)</span> model, but not as systematically as in the <span class="math inline">\(s_2\)</span> model – here it seems to mostly be the result of some outliers.</p>
<p>There may be ways of fiddling around with the <span class="math inline">\(s_{2-3}\)</span> models to get nicer residual distributions, such as telling <code>bam()</code> to assume non-Gaussian error distributions, but a drawback of these is that they are less well-understood. Since my main focus here is the <span class="math inline">\(s_1\)</span> model, I’ll leave the <span class="math inline">\(s_{2-3}\)</span> models as they are.</p>
</div>
</div>
</div>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
<p>PC<sub>1</sub> accounts for 58.4% of spectral variance, PC<sub>2</sub> accounts for 18.2%, and PC<sub>3</sub> accounts for 9.3%. The variance explained by PC<sub>1–3</sub> is visualized in <a href="#fig-fpcs">Figure&nbsp;3</a>. The plots all show the mean spectrum and the shape of the mean spectrum when weighted by the first and third quantile of all PC scores. This gives an indication of what spectra with a relatively high score <span class="math inline">\(s_i\)</span> and a relatively low <span class="math inline">\(s_i\)</span> look like.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Convenience functions for visualizing functional PCs
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here I’ll present a convenience function for visualizing principal shapes in a way that I think is very useful for interpreting them. It plots the mean spectrum – available in the object returned by <code>FPCA()</code> as <code>$mu</code> – as well as the shape of a ‘relatively low score’ in red and a ‘relatively high score’ in blue. This is achieved by respectively weighing the mean spectral shape by the first and third quantile of <span class="math inline">\(s_i\)</span>. PCs, i.e.&nbsp;principal shapes, are stored as a matrix <code>$phi</code> in the object returned by <code>FPCA()</code>, each column corresponding to a numeric vector over an observation grid stored in <code>$obsGrid</code>, which in our case corresponds to a frequency range between 500–8000 Hz. Plotting these is straightforward. Here is the first PC:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>fpca_t<span class="sc">$</span>obsGrid, <span class="at">y=</span>fpca_t<span class="sc">$</span>phi[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">'l'</span>, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="st">'Frequency (Hz)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>If we want to show how a very high score <span class="math inline">\(s_1 = 30\)</span> affects spectral shape, we can weigh the mean spectrum by <span class="math inline">\(30\phi_1\)</span> like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>very_high_s1 <span class="ot">&lt;-</span> fpca_t<span class="sc">$</span>mu <span class="sc">+</span> <span class="dv">30</span><span class="sc">*</span>fpca_t<span class="sc">$</span>phi[,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plotted here with the mean spectrum as a dotted line for reference:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>fpca_t<span class="sc">$</span>obsGrid, <span class="at">y=</span>very_high_s1, <span class="at">type=</span><span class="st">'l'</span>, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="st">'Frequency (Hz)'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>fpca_t<span class="sc">$</span>obsGrid, <span class="at">y=</span>fpca_t<span class="sc">$</span>mu, <span class="at">lty=</span><span class="st">'dotted'</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="dv">4200</span>, <span class="at">y=</span><span class="fl">0.9</span>, <span class="at">labels=</span><span class="fu">expression</span>(Spectrum<span class="sc">~</span>with<span class="sc">~</span>very<span class="sc">~</span>high<span class="sc">~</span>s[<span class="dv">1</span>]))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="dv">6500</span>, <span class="at">y=</span><span class="fl">0.3</span>, <span class="at">labels=</span><span class="st">'Mean spectrum'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Now – back to the convenience function, which takes the arguments <code>fpca_obj</code>, an object returned by <code>FPCA()</code>, the number of the PC to plot <code>fpc</code>, and a plot title <code>title</code>. It should be simple enough to change for other purposes, but for now the axis and legend labels make it suitable for spectra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fpc_viz <span class="ot">&lt;-</span> <span class="cf">function</span>(fpca_obj, fpc, title){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bin =</span> fpca_obj<span class="sc">$</span>obsGrid, <span class="at">mu =</span> fpca_obj<span class="sc">$</span>mu,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">highq =</span> fpca_obj<span class="sc">$</span>mu <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">quantile</span>(fpca_obj<span class="sc">$</span>xiEst[,fpc])[<span class="dv">2</span>] <span class="sc">*</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                       fpca_obj<span class="sc">$</span>phi[,fpc],</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lowq =</span> fpca_obj<span class="sc">$</span>mu <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">quantile</span>(fpca_obj<span class="sc">$</span>xiEst[,fpc])[<span class="dv">4</span>] <span class="sc">*</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                       fpca_obj<span class="sc">$</span>phi[,fpc]) <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(mu, highq, lowq)) <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(bin, value, <span class="at">color=</span>name)) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">'Frequency (Hz.)'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Amplitude (std.)'</span>) <span class="sc">+</span> </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'blue'</span>, <span class="st">'grey'</span>),</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Low'</span>, <span class="st">'High'</span>, <span class="st">'Mean</span><span class="sc">\n</span><span class="st">spectrum'</span>))</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plt)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  fpca_t <span class="sc">%&gt;%</span> <span class="fu">fpc_viz</span>(<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">bquote</span>(PC[<span class="dv">1</span>])) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.35</span>, <span class="fl">0.75</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  fpca_t <span class="sc">%&gt;%</span> <span class="fu">fpc_viz</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">bquote</span>(PC[<span class="dv">2</span>])) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.35</span>, <span class="fl">0.75</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  fpca_t <span class="sc">%&gt;%</span> <span class="fu">fpc_viz</span>(<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">bquote</span>(PC[<span class="dv">3</span>])) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.35</span>, <span class="fl">0.75</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">1</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fpcs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fpcs-1.png" class="img-fluid figure-img" width="384"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Variance in release spectra captured by PC<sub>1–3</sub> and the effect of weighting the mean by high and low scores <span class="math inline">\(s_{1-3}\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>The average spectrum has little energy below 1.5 kHz, relatively high amplitude at frequencies between 1.5–4.5 kHz, gradual energy loss above that, and peaks just below 2.5 kHz. The main source of variance, captured by PC<sub>1</sub>, is the location and magnitude of the primary peak. Positive <span class="math inline">\(s_1\)</span> corresponds to a lower frequency peak, and generally more energy at lower frequencies. COG would likely have captured some of the same information as PC<sub>1</sub>, but they are not equivalent: in addition to the location of the peak, PC<sub>1</sub> also captures information about variance in spectral slope, peak amplitude, and skew. Given what we know about aspiration and alveolar frication, strong negative <span class="math inline">\(s_1\)</span> seems to represent an alveolar noise source, and strong positive <span class="math inline">\(s_1\)</span> seems to represent a glottal noise source. PC<sub>2</sub> captures variance in the magnitude of the main peak. Positive <span class="math inline">\(s_2\)</span> corresponds to a more prominent peak, and less energy at higher frequencies, while negative <span class="math inline">\(s_2\)</span> corresponds to a less prominent peak, and more energy at higher frequencies. PC<sub>3</sub> mostly captures information about the peakedness of the energy distribution. Positive <span class="math inline">\(s_3\)</span> corresponds to a more restricted and more prominent peak in the same location as in the mean spectrum, and negative <span class="math inline">\(s_3\)</span> corresponds to a broader distribution of energy.</p>
<p>The GAMM modelling <span class="math inline">\(s_1\)</span> was fitted with all candidate independent variables except <span class="smallcaps">stress</span>. This model has a medium strong effect size of <span class="math inline">\(R^2 = .39\)</span>. A likelihood ratio test found that a model including the geographical variable <span class="smallcaps">lon,lat</span> performed significantly better than a nested model without this variable, with <span class="math inline">\(\chi^2(3) = 4.1\)</span>, <span class="math inline">\(p=0.043\)</span>. The influence of the geographical variable is plotted on a map in <a href="#fig-gam-fit">Figure&nbsp;4</a>; <a href="#fig-gam-fit">Figure&nbsp;4</a> shows that negative <span class="math inline">\(s_1\)</span> is common in Djursland and the surrounding area in mid-eastern Jutland (see <a href="#fig-locs">Figure&nbsp;2</a>); we return to this below. All other variables also significantly influence <span class="math inline">\(s_1\)</span> (see <a href="#tbl-gam-summary">Table&nbsp;1</a>). The upshot is that there is less energy at high frequencies before non-high, particularly low, vowels; before rounded vowels; before back vowels; in non-palatalized releases; and in tokens from male speakers. Finally, there is an inverse relationship between VOT and <span class="math inline">\(s_1\)</span>, such that shorter VOT corresponds to higher <span class="math inline">\(s_1\)</span>. These are all expected patterns, similar to what is found in MSD <span class="citation" data-cites="puggaardrode2022_fosr">(<a href="#ref-puggaardrode2022_fosr" role="doc-biblioref">Puggaard-Rode 2022b</a>)</span>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>gam_pc1_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(gam_pc1, <span class="at">re.test=</span>F)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">length</span>(gam_pc1_summary<span class="sc">$</span>p.coef)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'intercept'</span>, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[height]{.smallcaps}: - non-high, + high'</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[height]{.smallcaps}: - low, + mid'</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[sex]{.smallcaps}: - female, + male'</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[backness]{.smallcaps}: - back, + non-back'</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[round]{.smallcaps}: - non-round, + round'</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[palatalization]{.smallcaps}: - non-pal., + pal.'</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">'[VOT]{.smallcaps}'</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(gam_pc1_summary<span class="sc">$</span>p.coef, <span class="dv">2</span>))</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(gam_pc1_summary<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span>len], <span class="dv">2</span>))</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(gam_pc1_summary<span class="sc">$</span>p.t, <span class="dv">2</span>))</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">round</span>(gam_pc1_summary<span class="sc">$</span>p.pv, <span class="dv">3</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>p[<span class="fu">which</span>(p <span class="sc">&lt;</span> <span class="fl">0.001</span>)] <span class="ot">&lt;-</span> <span class="st">'&lt;.001'</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>gam_pc1_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> var,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> est,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> se,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> t,</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> p</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(gam_pc1_table) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gam_pc1_table)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">'$SE$'</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gam_pc1_table)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">'$t$-value'</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gam_pc1_table)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">'$p$-value'</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>gam_pc1_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<div id="tbl-gam-summary" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;1: Parametric coefficients of GAMM modeling <span class="math inline">\(s_1\)</span>.</caption>
<colgroup>
<col style="width: 40%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Estimate</th>
<th style="text-align: left;"><span class="math inline">\(SE\)</span></th>
<th style="text-align: left;"><span class="math inline">\(t\)</span>-value</th>
<th style="text-align: left;"><span class="math inline">\(p\)</span>-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">intercept</td>
<td style="text-align: left;">-1.46</td>
<td style="text-align: left;">1.39</td>
<td style="text-align: left;">-1.05</td>
<td style="text-align: left;">0.294</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="smallcaps">height</span>: - non-high, + high</td>
<td style="text-align: left;">-3.65</td>
<td style="text-align: left;">0.74</td>
<td style="text-align: left;">-4.96</td>
<td style="text-align: left;">&lt;.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="smallcaps">height</span>: - low, + mid</td>
<td style="text-align: left;">-4.38</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">-4.84</td>
<td style="text-align: left;">&lt;.001</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="smallcaps">sex</span>: - female, + male</td>
<td style="text-align: left;">6.26</td>
<td style="text-align: left;">1.87</td>
<td style="text-align: left;">3.35</td>
<td style="text-align: left;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="smallcaps">backness</span>: - back, + non-back</td>
<td style="text-align: left;">-3.91</td>
<td style="text-align: left;">1.21</td>
<td style="text-align: left;">-3.22</td>
<td style="text-align: left;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="smallcaps">round</span>: - non-round, + round</td>
<td style="text-align: left;">3.47</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">3.58</td>
<td style="text-align: left;">&lt;.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="smallcaps">palatalization</span>: - non-pal., + pal.</td>
<td style="text-align: left;">-6.79</td>
<td style="text-align: left;">2.03</td>
<td style="text-align: left;">-3.35</td>
<td style="text-align: left;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="smallcaps">VOT</span></td>
<td style="text-align: left;">-2.03</td>
<td style="text-align: left;">0.69</td>
<td style="text-align: left;">-2.95</td>
<td style="text-align: left;">0.003</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>mgcv</code> summary of <span class="math inline">\(s_1\)</span> model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In case you want to have a closer look at the model summary.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_pc1, <span class="at">re.test=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
fpc1 ~ height + gender + bkn2l + round + pal + st_vot + s(lat, 
    long) + s(parish, bs = "re") + s(parish, by = st_vot, bs = "re") + 
    s(parish, by = height, bs = "re") + s(parish, by = round, 
    bs = "re") + s(parish, by = bkn2l, bs = "re") + s(parish, 
    by = pal, bs = "re")

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.4559     1.3884  -1.049 0.294411    
height-ml+h   -3.6468     0.7358  -4.956 7.45e-07 ***
height-l+m    -4.3846     0.9067  -4.836 1.37e-06 ***
gender-f+m     6.2587     1.8695   3.348 0.000821 ***
bkn2l-bk+nbk  -3.9056     1.2125  -3.221 0.001286 ** 
round-nrd+rd   3.4728     0.9691   3.584 0.000342 ***
pal-npl+pl    -6.7866     2.0282  -3.346 0.000826 ***
st_vot        -2.0303     0.6882  -2.950 0.003191 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
              edf Ref.df     F p-value
s(lat,long) 4.886  5.174 1.304   0.219

R-sq.(adj) =  0.392   Deviance explained = 44.7%
fREML =  21888  Scale est. = 262.78    n = 5105</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Overlaying GAMM fits on maps
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I use some home-cooked functions for overlaying the model results on a map of Jutland, which I’ll quickly introduce here. These functions are adapted in part from the <code>mgcViz</code> package <span class="citation" data-cites="fasiolo2020 fasiolo2021">(<a href="#ref-fasiolo2020" role="doc-biblioref">Fasiolo et al. 2020</a>; <a href="#ref-fasiolo2021" role="doc-biblioref">2021</a>)</span>, in particular the <code>l_fitRaster()</code> function, and the helper functions published along with <span class="citation" data-cites="bauer2018">Bauer et al. (<a href="#ref-bauer2018" role="doc-biblioref">2018</a>)</span> in the developmental package <code>FoSIntro</code>, in particular the <code>plot_2Dheatmap()</code> function.</p>
<p>The function <code>gam_map_extract_fit()</code> returns the data frame used to plot the heat maps. It takes four arguments:</p>
<ul>
<li><code>mod</code> is the fitted model object</li>
<li><code>select</code> is an identifier for the smooth variable to be plotted corresponding to the order of variables fitted with <code>s()</code> in the model call. Default is <code>1</code>.</li>
<li><code>ci</code> are confidence intervals to be returned as a percentage. Default is <code>NULL</code>, which is equivalent to <code>95</code>, and returns upper and lower 95% confidence intervals. (I don’t use those here, but I do in another forthcoming paper).</li>
<li><code>sig_level</code> is the significance level of interest. Default is <code>1</code>, which means that all fitted values are plotted. The plot will be white in areas where the <span class="math inline">\(p\)</span>-value is below <code>sig_level</code>.</li>
</ul>
<p>It works like this: A vector of fitted values and standard errors corresponding to evenly spaced coordinates are extracted from the model fit using the <code>mgcv</code> function <code>plot.gam()</code> and converted into a data frame. Using the fitted values and standard errors, columns are added with a <span class="math inline">\(p\)</span>-value for each coordinate, a Boolean column <code>alpha</code> stating whether that <span class="math inline">\(p\)</span>-level is below the <code>sig_level</code> threshold, and for lower and upper confidence interval bounds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>gam_map_extract_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, <span class="at">select=</span><span class="dv">1</span>, <span class="at">ci=</span><span class="cn">NULL</span>, <span class="at">sig_level=</span><span class="dv">1</span>) {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="st">'tmp'</span>)   <span class="co">#suppress actual plot</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  plot.df <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">plot.gam</span>(mod, <span class="at">select=</span><span class="dv">1</span>, <span class="at">rug=</span>F)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlink</span>(<span class="st">'tmp'</span>, <span class="at">recursive=</span>T)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  plot.df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(plot.df, <span class="cf">function</span>(x) {</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>raw <span class="ot">&lt;-</span> <span class="cn">NULL</span>   <span class="co">#remove large and (for our purposes) unneccesary raw component</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  plot.df <span class="ot">&lt;-</span> plot.df[[select]]   <span class="co">#limit to the right smooth effect</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(plot.df<span class="sc">$</span>x, plot.df<span class="sc">$</span>y)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(plot.df<span class="sc">$</span>fit)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(plot.df<span class="sc">$</span>se)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(plot_data<span class="sc">$</span>fit)<span class="sc">/</span>plot_data<span class="sc">$</span>se)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>alpha <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>p <span class="sc">&lt;</span> sig_level</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ci)) {ci <span class="ot">&lt;-</span> <span class="dv">95</span>}</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  cip <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>ci<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>ci_lower <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>fit <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>cip<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>plot_data<span class="sc">$</span>se</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  plot_data<span class="sc">$</span>ci_upper <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>fit <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>cip<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>plot_data<span class="sc">$</span>se</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot_data)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>gam_map()</code> produces the actual plot. It calls <code>gam_map_extract_fit()</code> under the hood with supplied values. It further takes the obligatory argument <code>poly_obj</code> which is a data frame containing information for plotting the map as a polygon. The argument <code>fill</code> clarifies which value to plot; default is the model fit <code>'fit'</code>, but other options are <code>'p'</code> for plotting <span class="math inline">\(p\)</span>-values by coordinates, <code>'se'</code> for plotting standard errors by coordinates, and <code>'ci_lower'</code> and <code>'ci_upper'</code> for plotting lower and upper CI boundaries (see further below). The argument <code>legend_name</code> is the string to print above the legend.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>gam_map <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, poly_obj, <span class="at">select=</span><span class="dv">1</span>, <span class="at">sig_level=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">'fit'</span>, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend_name=</span><span class="st">'estimate'</span>, ...) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">gam_map_extract_fit</span>(mod, select, <span class="at">sig_level=</span>sig_level)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(p, <span class="fu">aes_string</span>(<span class="at">x=</span><span class="st">'Var1'</span>, <span class="at">y=</span><span class="st">'Var2'</span>, <span class="at">fill =</span> fill)) <span class="sc">+</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">alpha =</span> p<span class="sc">$</span>alpha) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">'red'</span>, <span class="at">mid =</span> <span class="st">'white'</span>, <span class="at">high =</span> <span class="st">'blue'</span>, </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.value=</span><span class="st">'grey'</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> legend_name, ...) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>(<span class="fl">1.7</span>) <span class="sc">+</span>   <span class="co">#needed for map to have proper dimensions</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data=</span>poly_obj, <span class="fu">aes</span>(<span class="at">x=</span>lat, <span class="at">y=</span>long, <span class="at">group=</span>dialect),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color=</span><span class="st">'black'</span>, <span class="at">inherit.aes=</span>F, <span class="at">lwd=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks=</span><span class="fu">element_blank</span>())</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These functions should in theory be quite adaptable, but I haven’t tested them with other map polygons so issues may well pop up. Feel free to reach out if you want to use them but can’t for some reason, I’d be happy to have a look.</p>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dia_gam_fit <span class="ot">&lt;-</span> <span class="fu">gam_map</span>(gam_pc1, dia_polygon)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>dia_gam_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-gam-fit" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-gam-fit-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Fitted <span class="math inline">\(s_1\)</span> values attributable to area.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The stability of the geographical effects
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For a closer look at the geographical effect, let’s have a look at versions of <a href="#fig-gam-fit">Figure&nbsp;4</a> which are only colored in when the <span class="math inline">\(p\)</span>-value is above a certain threshold.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gam_map</span>(gam_pc1, dia_polygon, <span class="at">sig_level =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Colored where p &lt; 0.05'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What we see is that the geographical effect is largely unstable and not significant; with a significance threshold of <span class="math inline">\(p&lt;0.05\)</span>, (almost) only an area in central eastern Jutland is shown as having significantly lower <span class="math inline">\(s_1\)</span> than the rest of the peninsula.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gam_map</span>(gam_pc1, dia_polygon, <span class="at">sig_level =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Colored where p &lt; 0.01'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With a significance threshold of <span class="math inline">\(p&lt;0.01\)</span>, the effect is really neatly limited to the peninsula of Djursland.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reconstructing spectra from FPCA and GAMM fits
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I showed above how to plot the influence of PC scores relative to the mean. It’s worth having a look at the magnitude of the geographical effects in terms of principal shapes. In <a href="#fig-gam-fit">Figure&nbsp;4</a>, we can see that the area with the highest fitted <span class="math inline">\(s_1\)</span> has an estimated score of about 2, and the lowest fitted <span class="math inline">\(s_1\)</span> is estimated around -6. Recall though that smooth effects in GAMMs fitted with <code>mgcv</code> are always zero-centered, so these numbers must be interpreted relative to the model’s intercept of -1.46 (see <a href="#tbl-gam-summary">Table&nbsp;1</a>); in other words, the highest fitted geographical effect is actually very close to zero (the mean spectrum computed with <code>FPCA()</code>), and the lowest fitted effect is closer to -8.</p>
<p>I saved the <code>ggplot</code> object used to plot <a href="#fig-gam-fit">Figure&nbsp;4</a> above as <code>dia_gam_fit</code>, so we can extract the exact minima and maxima from the plot legend from that and add the intercept to get actual predicted <span class="math inline">\(s_1\)</span> values for different areas on the map. These <code>ggplot</code> objects have a confusing structure, but the values used to color in the individual pixels on the plot are all stored in <code>$plot_env$p$fit</code>. Here’s the highest fitted <span class="math inline">\(s_1\)</span> on the <a href="#fig-gam-fit">Figure&nbsp;4</a> legend:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>high_pc1 <span class="ot">&lt;-</span> dia_gam_fit<span class="sc">$</span>plot_env<span class="sc">$</span>p<span class="sc">$</span>fit <span class="sc">%&gt;%</span> <span class="fu">max</span>(<span class="at">na.rm=</span>T) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  gam_pc1<span class="sc">$</span>coefficients[<span class="st">'(Intercept)'</span>]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">bin =</span> fpca_t<span class="sc">$</span>obsGrid, <span class="at">mu =</span> fpca_t<span class="sc">$</span>mu,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">high_pc1 =</span> fpca_t<span class="sc">$</span>mu <span class="sc">+</span> high_pc1 <span class="sc">*</span> fpca_t<span class="sc">$</span>phi[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(mu, high_pc1)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bin, value, <span class="at">color=</span>name)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Frequency (Hz.)'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Amplitude (std.)'</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'grey'</span>),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="fu">element_blank</span>(),</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">bquote</span>(High<span class="sc">~</span>s[<span class="dv">1</span>]),</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Mean</span><span class="sc">\n</span><span class="st">spectrum'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>It’s basically indistinguishable from the mean spectrum. Here’s the lowest fitted <span class="math inline">\(s_1\)</span>:</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>low_pc1 <span class="ot">&lt;-</span> dia_gam_fit<span class="sc">$</span>plot_env<span class="sc">$</span>p<span class="sc">$</span>fit <span class="sc">%&gt;%</span> <span class="fu">min</span>(<span class="at">na.rm=</span>T) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  gam_pc1<span class="sc">$</span>coefficients[<span class="st">'(Intercept)'</span>]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">bin =</span> fpca_t<span class="sc">$</span>obsGrid, <span class="at">mu =</span> fpca_t<span class="sc">$</span>mu,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">low_pc1 =</span> fpca_t<span class="sc">$</span>mu <span class="sc">+</span> low_pc1 <span class="sc">*</span> fpca_t<span class="sc">$</span>phi[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(mu, low_pc1)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(bin, value, <span class="at">color=</span>name)) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Frequency (Hz.)'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Amplitude (std.)'</span>) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'grey'</span>),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="fu">element_blank</span>(),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">bquote</span>(Low<span class="sc">~</span>s[<span class="dv">1</span>]),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Mean</span><span class="sc">\n</span><span class="st">spectrum'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Much more of an interpretable difference in shape here.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exploring random effects from the <span class="math inline">\(s_1\)</span> model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In addition to just looking at the predicted effect of <code>s(lat,long)</code>, it’d be nice to have a look at speaker-specific properties as well. All coefficients of the model are stored in the <code>$coefficients</code> component of the object returned by <code>bam()</code>. We can grab the random intercepts by simply filtering the <code>$coefficients</code> to rows called something starting with <code>s(parish).</code>, since <code>parish</code> is the name of our random intercept. We have the coordinates associated with different parishes in the <code>coordinates</code> data frame, so we can use this information to create a map similar to <a href="#fig-locs">Figure&nbsp;2</a> where the dots are colored in according to the predicted by-speaker intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>re_names <span class="ot">&lt;-</span> gam_pc1<span class="sc">$</span>model<span class="sc">$</span>parish <span class="sc">%&gt;%</span> <span class="fu">levels</span>()</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> gam_pc1<span class="sc">$</span>coefficients</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>re_coefs <span class="ot">&lt;-</span> coefs[<span class="fu">which</span>(<span class="fu">str_sub</span>(<span class="fu">names</span>(coefs), <span class="at">end=</span><span class="dv">10</span>) <span class="sc">==</span> <span class="st">'s(parish).'</span>)]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">parish =</span> re_names,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">coefs =</span> re_coefs) <span class="sc">%&gt;%</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(coordinates) <span class="sc">%&gt;%</span> </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>lat, <span class="at">y=</span>long, <span class="at">color=</span>coefs) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>dia_polygon, <span class="fu">aes</span>(<span class="at">x=</span>lat, <span class="at">y=</span>long, <span class="at">group=</span>dialect),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">'lightgrey'</span>, <span class="at">color=</span><span class="st">'grey'</span>, <span class="at">lwd=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.7</span>) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">'red'</span>, <span class="at">mid=</span><span class="st">'white'</span>, <span class="at">high=</span><span class="st">'blue'</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name=</span><span class="st">'Random</span><span class="sc">\n</span><span class="st">intercepts'</span>) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is very interesting – there’s obviously a lot of random by-speaker variation, although perhaps a slight tendency in favor of individuals with lower <span class="math inline">\(s_1\)</span> scores in the south and higher <span class="math inline">\(s_1\)</span> scores in the north. This isn’t what the <code>s(lat,long)</code> smooth shows, but seems to be in line with a lot of Danish speakers’ intuitions.</p>
</div>
</div>
</div>
<p>Fewer variables contribute to the GAMM modeling <span class="math inline">\(s_2\)</span>: <span class="smallcaps">height, round, stress</span>, and <span class="smallcaps">backness</span>. The geographical variable <span class="smallcaps">lon,lat</span> does not significantly improve the fit of this model. The final model has a medium effect size, with <span class="math inline">\(R^2 = .29\)</span>. Only two variables significantly influence <span class="math inline">\(s_2\)</span>, namely <span class="smallcaps">back</span> with <span class="math inline">\(\hat{\beta} = 1.97\)</span>, <span class="math inline">\(SE = 0.7\)</span>, <span class="math inline">\(t = 2.82\)</span>, <span class="math inline">\(p &lt; .01\)</span>, and <span class="smallcaps">round</span> with <span class="math inline">\(\hat{\beta} = 2.21\)</span>, <span class="math inline">\(SE = 0.61\)</span>, <span class="math inline">\(t = 3.6\)</span>, <span class="math inline">\(p &lt; .001\)</span>. In other words, positive <span class="math inline">\(s_2\)</span>, associated with an especially prominent energy peak around 2.5 kHz, is especially found before non-back and non-round vowels. This is also in line with previous findings for MSD <span class="citation" data-cites="puggaardrode2022_fosr">(<a href="#ref-puggaardrode2022_fosr" role="doc-biblioref">Puggaard-Rode 2022b</a>)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>mgcv</code> summary of <span class="math inline">\(s_2\)</span> model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_pc2, <span class="at">re.test=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
fcp2 ~ height + stress + bkn2l + round + s(parish, bs = "re") + 
    s(parish, by = height, bs = "re") + s(parish, by = round, 
    bs = "re") + s(parish, by = stress, bs = "re") + s(parish, 
    by = bkn2l, bs = "re")

Parametric coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -0.2099     0.4512  -0.465 0.641771    
height-ml+h    -0.2987     0.3711  -0.805 0.420928    
height-l+m      0.2016     0.5399   0.373 0.708923    
stress-nst+st  -0.3627     0.3800  -0.954 0.339958    
bkn2l-bk+nbk    1.9703     0.6990   2.819 0.004843 ** 
round-nrd+rd    2.2116     0.6148   3.597 0.000325 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
     edf Ref.df F p-value

R-sq.(adj) =  0.285   Deviance explained = 33.7%
fREML =  19408  Scale est. = 102.85    n = 5105</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>All parametric candidate variables contribute to the GAMM modeling <span class="math inline">\(s_3\)</span>; the geographical variable does not significantly improve the fit of this model. The resulting model has a medium small effect size of <span class="math inline">\(R^2 = .25\)</span>. The only variable found to significantly influence <span class="math inline">\(s_3\)</span> is <span class="smallcaps">round</span>, with <span class="math inline">\(\hat{\beta} = 2.62\)</span>, <span class="math inline">\(SE = 0.45\)</span>, <span class="math inline">\(t = -5.84\)</span>, <span class="math inline">\(p &lt; .001\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>mgcv</code> summary of <span class="math inline">\(s_3\)</span> model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_pc3, <span class="at">re.test=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
fpc3 ~ height + stress + gender + bkn2l + round + pal + st_vot + 
    s(parish, bs = "re") + s(parish, by = st_vot, bs = "re") + 
    s(parish, by = height, bs = "re") + s(parish, by = round, 
    bs = "re") + s(parish, by = stress, bs = "re") + s(parish, 
    by = bkn2l, bs = "re") + s(parish, by = pal, bs = "re")

Parametric coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -0.8418     0.5203  -1.618    0.106    
height-ml+h    -0.4148     0.2613  -1.588    0.112    
height-l+m      0.1173     0.4037   0.291    0.771    
stress-nst+st  -0.3727     0.2504  -1.489    0.137    
gender-f+m     -0.7487     0.6419  -1.166    0.244    
bkn2l-bk+nbk   -0.6435     0.5193  -1.239    0.215    
round-nrd+rd   -2.6218     0.4493  -5.835 5.74e-09 ***
pal-npl+pl     -1.0944     0.8465  -1.293    0.196    
st_vot         -0.3502     0.3225  -1.086    0.278    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
     edf Ref.df F p-value

R-sq.(adj) =  0.248   Deviance explained = 30.3%
fREML =  17793  Scale est. = 55.065    n = 5105</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-and-conclusions" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Discussion and conclusions</h1>
<p>Spectral shapes that suggest a coronal noise source are found in /t/ release midpoints in the varieties of eastern Jutland, particularly in Djursland, but not in other traditional varieties of Jutland Danish. This suggests that /t/ affrication was not historically a feature of most varieties of Jutland Danish.</p>
<p>Indeed, it is possible that /t/ affrication was not a feature of any traditional Jutlandic varieties. Southern Djursland coincides with the main water route between Jutland and the island of Zealand, which is where the capital (Copenhagen) and consequently the locus of Standard Danish is located. This is also where the largest city of Jutland (Aarhus) is located, and several of the major historical cities of Jutland are located immediately south of Aarhus <span class="citation" data-cites="puggaard2021">(<a href="#ref-puggaard2021" role="doc-biblioref">Puggaard 2021</a>)</span>. Affrication may be a traditional feature of this area, but the feature may also have spread early from Standard Danish to Aarhus and from there to adjacent rural areas. This would be in line with the <em>cascade model</em> of interdialectal influence <span class="citation" data-cites="labov2003">(<a href="#ref-labov2003" role="doc-biblioref">Labov 2003</a>)</span>, which predicts that change spreads between population centers in a manner that is predictable from a combination of population size and geographical distance, thus also affecting rural areas close to major cities relatively early.</p>
<p>PC<sub>1</sub> capture the two most readily interpretable sources of variance in the release midpoint spectra: the location and relative magnitude of the energy peak. PC<sub>1</sub> seems to largely capture the difference between aspiration and affrication noise, which is modulated by both geography and phonetic context; lower PCs seem to capture effects of coarticulation, and these do not differ substantially across regional varieties. The influence of phonetic context on PC<sub>1–2</sub> is largely predictable, and is similar to what has been shown for MSD <span class="citation" data-cites="puggaardrode2022_fosr">(<a href="#ref-puggaardrode2022_fosr" role="doc-biblioref">Puggaard-Rode 2022b</a>)</span>; for example, the main peak is usually found at higher frequencies before high, non-back, and non-round vowels, in palatalized tokens, in stressed syllables, and in female speakers. The fact that these contextual phonetic effects all behave as expected are an indication that FPCA can indeed be fruitfully used to decompose variance in spectral characteristics. A possible venue to explore in future research would be using FPCA to decompose variance in the trajectories of spectral measures over the time course of stop bursts and releases.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Session info
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Note that the GAMMs were fitted on the IPS server with a slightly newer version of <code>mgcv</code> (1.8.42). It shouldn’t have any effect on the results though.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22621)

Matrix products: default

locale:
[1] LC_COLLATE=Danish_Denmark.utf8  LC_CTYPE=Danish_Denmark.utf8   
[3] LC_MONETARY=Danish_Denmark.utf8 LC_NUMERIC=C                   
[5] LC_TIME=Danish_Denmark.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] mgcv_1.8-41       nlme_3.1-160      gridExtra_2.3     fdapace_0.5.9    
 [5] multitaper_1.0-15 phonTools_0.2-2.1 seewave_2.2.0     rPraat_1.3.2-1   
 [9] eurostat_3.8.2    patchwork_1.1.2   lubridate_1.9.2   forcats_1.0.0    
[13] stringr_1.5.0     dplyr_1.1.2       purrr_1.0.1       readr_2.1.4      
[17] tidyr_1.3.0       tibble_3.2.1      ggplot2_3.4.2     tidyverse_2.0.0  

loaded via a namespace (and not attached):
 [1] sf_1.0-13           httr_1.4.6          rprojroot_2.0.3    
 [4] numDeriv_2016.8-1.1 tools_4.2.2         backports_1.4.1    
 [7] utf8_1.2.3          R6_2.5.1            rpart_4.1.19       
[10] KernSmooth_2.23-20  Hmisc_5.1-0         DBI_1.1.3          
[13] colorspace_2.1-0    nnet_7.3-18         withr_2.5.0        
[16] tidyselect_1.2.0    curl_5.0.0          compiler_4.2.2     
[19] cli_3.6.1           htmlTable_2.4.1     xml2_1.3.4         
[22] labeling_0.4.2      scales_1.2.1        checkmate_2.2.0    
[25] classInt_0.4-9      proxy_0.4-27        rappdirs_0.3.3     
[28] digest_0.6.31       tuneR_1.4.4         foreign_0.8-83     
[31] rmarkdown_2.22      base64enc_0.1-3     pkgconfig_2.0.3    
[34] htmltools_0.5.5     bibtex_0.5.1        fastmap_1.1.1      
[37] htmlwidgets_1.6.2   rlang_1.1.1         readxl_1.4.2       
[40] rstudioapi_0.14     farver_2.1.1        generics_0.1.3     
[43] jsonlite_1.8.4      magrittr_2.0.3      Formula_1.2-5      
[46] Matrix_1.5-1        Rcpp_1.0.10         munsell_0.5.0      
[49] fansi_1.0.4         RefManageR_1.4.0    lifecycle_1.0.3    
[52] stringi_1.7.12      yaml_2.3.7          MASS_7.3-58.1      
[55] plyr_1.8.8          grid_4.2.2          regions_0.1.8      
[58] lattice_0.20-45     splines_4.2.2       hms_1.1.3          
[61] knitr_1.43          pillar_1.9.0        ISOweek_0.6-2      
[64] glue_1.6.2          evaluate_0.21       data.table_1.14.8  
[67] vctrs_0.6.2         tzdb_0.4.0          cellranger_1.1.0   
[70] gtable_0.3.3        assertthat_0.2.1    xfun_0.39          
[73] broom_1.0.4         countrycode_1.5.0   pracma_2.4.2       
[76] e1071_1.7-13        class_7.3-20        signal_0.7-7       
[79] units_0.8-2         cluster_2.1.4       timechange_0.2.0   
[82] here_1.0.1         </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-andersen1981" class="csl-entry" role="listitem">
Andersen, Torben Arboe. 1981. Dialektbånd og databehandling. <em>Ord &amp; Sag</em> 1, 11–18.
</div>
<div id="ref-bauer2018" class="csl-entry" role="listitem">
Bauer, Alexander, Fabian Scheipl, Helmut Küchenhoff &amp; Alice-Agnes Gabriel. 2018. An introduction to semiparametric function-on-scalar regression. <em>Statistical Modelling</em> 18(3), 346–364. doi:<a href="https://doi.org/10.1177/1471082X17748034">10.1177/1471082X17748034</a>.
</div>
<div id="ref-bennike1898" class="csl-entry" role="listitem">
Bennike, Valdemar &amp; Marius Kristensen. 1898–1912. <em>Kort over de danske folkemål med forklaringer</em>. Copenhagen: Gyldendalske Boghandel.
</div>
<div id="ref-boersma2021" class="csl-entry" role="listitem">
Boersma, Paul &amp; David Weenink. 2021. <em>Praat. Doing phonetics by computer</em>. Version 6.2.04. <a href="http://www.fon.hum.uva.nl/praat/">http://www.fon.hum.uva.nl/praat/</a>.
</div>
<div id="ref-brink1975" class="csl-entry" role="listitem">
Brink, Lars &amp; Jørn Lund. 1975. <em>Dansk rigsmål. Lydudviklingen siden 1840 med særligt henblik på sociolekterne i københavn</em>. Copenhagen: Gyldendal.
</div>
<div id="ref-bunnell2004" class="csl-entry" role="listitem">
Bunnell, H. Timothy, James Polikoff &amp; Jane McNicholas. 2004. Spectral moment vs. <span class="nocase">bark</span> cepstral analysis of children’s word-initial voiceless stops. <em>8th <span class="nocase">International Conference on Spoken Language Processing</span></em> (Interspeech 2004). Jeju: International Speech Communication Association. doi:<a href="https://doi.org/10.21437/Interspeech.2004-81">10.21437/Interspeech.2004-81</a>.
</div>
<div id="ref-dialektsamlingen" class="csl-entry" role="listitem">
Dialektsamlingen. 1971–1976. <a href="https://dansklyd.statsbiblioteket.dk/samling/dialektsamlingen/">https://dansklyd.statsbiblioteket.dk/samling/dialektsamlingen/</a>.
</div>
<div id="ref-fasiolo2021" class="csl-entry" role="listitem">
Fasiolo, Matteo, Raphael Nedellec, Yannig Goude, Christian Capezza &amp; Simon N. Wood. 2021. <code>mgcViz</code>. <em>Visualisations for generalized additive models</em>. Version 0.1.9. <a href="https://CRAN.R-project.org/package=mgcViz">https://CRAN.R-project.org/package=mgcViz</a>.
</div>
<div id="ref-fasiolo2020" class="csl-entry" role="listitem">
Fasiolo, Matteo, Raphaël Nedellec, Yannig Goude &amp; Simon N. Wood. 2020. Scalable visualization methods for modern generalized additive models. <em>Journal of Computational and Graphical Statistics</em> 29(1), 78–86. doi:<a href="https://doi.org/10.1080/10618600.2019.1629942">10.1080/10618600.2019.1629942</a>.
</div>
<div id="ref-fischerjorgensen1954" class="csl-entry" role="listitem">
Fischer-Jørgensen, Eli. 1954. Acoustic analysis of stop consonants. <em>Le Maître Phonetique</em> 32(69), 42–59.
</div>
<div id="ref-forrest1988" class="csl-entry" role="listitem">
Forrest, Karen, Gary Weismer, Paul Milenkovic &amp; Ronald N. Dougall. 1988. Statistical analysis of word-initial voiceless obstruents. Preliminary data. <em>Journal of the Acoustical Society of America</em> 84(1), 115–123. doi:<a href="https://doi.org/10.1121/1.396977">10.1121/1.396977</a>.
</div>
<div id="ref-goldshtein2021" class="csl-entry" role="listitem">
Goldshtein, Yonatan &amp; Liv Moeslund Ahlgren. 2021. Ideologies of language and place. Conflicting expectations to dialectal speech between informants and dialectologists. <em>Journal of Postcolonial Linguistics</em> 5, 178–203.
</div>
<div id="ref-goldshtein2019" class="csl-entry" role="listitem">
Goldshtein, Yonatan &amp; Rasmus Puggaard. 2019. Overblik over danske dialektoptagelser. <em>Ord &amp; Sag</em> 39, 18–28.
</div>
<div id="ref-gubian2011" class="csl-entry" role="listitem">
Gubian, Michele, Lou Boves &amp; Francesco Cangemi. 2011. Joint analysis of F0 and speech rate with functional data analysis. <em>IEEE International Conference on Acoustics, Speech, and Signal Processing</em>, 4972–4975.
</div>
<div id="ref-gubian2015" class="csl-entry" role="listitem">
Gubian, Michele, Francisco Torreira &amp; Lou Boves. 2015. Using functional data analysis for investigating multidimensional dynamic phonetic contrasts. <em>Journal of Phonetics</em> 49, 16–40. doi:<a href="https://doi.org/10.1016/j.wocn.2014.10.001">10.1016/j.wocn.2014.10.001</a>.
</div>
<div id="ref-heger1981" class="csl-entry" role="listitem">
Heger, Steffen. 1981. <em>Sprog og lyd. Elementær dansk fonetik</em>. Copenhagen: Akademisk Forlag.
</div>
<div id="ref-jespersen1899" class="csl-entry" role="listitem">
Jespersen, Otto. 1899. <em>Fonetik. En systematisk fremstilling af læren om sproglyd</em>. Copenhagen: Det Schubotheske Forlag.
</div>
<div id="ref-jongman2000" class="csl-entry" role="listitem">
Jongman, Allard, Ratree Wayland &amp; Serena Wong. 2000. Acoustic characteristics of <span>English</span> fricatives. <em>Journal of the Acoustical Society of America</em> 108(3), 1252–1263. doi:<a href="https://doi.org/10.1121/1.1288413">10.1121/1.1288413</a>.
</div>
<div id="ref-koenig2013" class="csl-entry" role="listitem">
Koenig, Laura L., Christine H. Shadle, Jonathan L. Preston &amp; Christine R. Mooshammer. 2013. Toward improved spectral measures of /s/. Results from adolescents. <em>Journal of Speech, Language, and Hearing Research</em> 56(4), 1175–1189. doi:<a href="https://doi.org/10.1044/1092-4388(2012/12-0038)">10.1044/1092-4388(2012/12-0038)</a>.
</div>
<div id="ref-kristiansen2003" class="csl-entry" role="listitem">
Kristiansen, Tore. 2003. Danish. In Ana Deumart &amp; Wim Vandenbussche (eds.), <em>Germanic standardizations. Past to present</em> (Impact. Studies in Language and Society 18), 69–91. Amsterdam &amp; Philadelphia: John Benjamins. doi:<a href="https://doi.org/10.1075/impact.18.04kri">10.1075/impact.18.04kri</a>.
</div>
<div id="ref-labov2003" class="csl-entry" role="listitem">
Labov, William. 2003. Pursuing the cascade model. In David Britain &amp; Jenny Cheshire (eds.), <em>Social dialectology. In honour of <span>Peter Trudgill</span></em> (Impact. Studies in Language and Society 16), 9–22. Amsterdam &amp; Philadelphia: John Benjamins. doi:<a href="https://doi.org/10.1075/impact.16.03lab">10.1075/impact.16.03lab</a>.
</div>
<div id="ref-pedersen2003" class="csl-entry" role="listitem">
Pedersen, Inge Lise. 2003. Traditional dialects of <span>Danish</span> and the de-dialectalization 1900–2000. <em>International Journal of the Sociology of Language</em> 159, 9–28. doi:<a href="https://doi.org/10.1515/ijsl.2003.012">10.1515/ijsl.2003.012</a>.
</div>
<div id="ref-petersen2021" class="csl-entry" role="listitem">
Petersen, Jan Heegård, Holger Juul, Nicolai Pharao &amp; Marie Maegaard. 2021. <em>Udtalt. En introduktionsbog til dansk fonetik</em>. Frederiksberg: Samfundslitteratur.
</div>
<div id="ref-petersen2009" class="csl-entry" role="listitem">
Petersen, Niels Reinholt. 2009. Affrikater. <em>Den store danske</em>. Gyldendal. <a href="https://denstoredanske.dk/Sprog,_religion_og_filosofi/Sprog/Fonologi/affrikater">https://denstoredanske.dk/Sprog,_religion_og_filosofi/Sprog/Fonologi/affrikater</a>.
</div>
<div id="ref-puggaard2021" class="csl-entry" role="listitem">
Puggaard, Rasmus. 2021. Modeling regional variation in voice onset time of <span>Jutlandic</span> varieties of <span>Danish</span>. In Hans Van de Velde, Nanna Haug Hilton &amp; Remco Knooihuizen (eds.), <em>Language variation. European perspectives <span>VIII</span></em> (Studies in Language Variation 25), 79–110. Amsterdam &amp; Philadelphia: John Benjamins. doi:<a href="https://doi.org/10.1075/silv.25.04pug">10.1075/silv.25.04pug</a>.
</div>
<div id="ref-puggaardrode2022_fosr" class="csl-entry" role="listitem">
Puggaard-Rode, Rasmus. 2022b. Analyzing time-varying spectral characteristics of speech with function-on-scalar regression. <em>Journal of Phonetics</em> 95, 101191. doi:<a href="https://doi.org/10.1016/j.wocn.2022.101191">10.1016/j.wocn.2022.101191</a>.
</div>
<div id="ref-disscode" class="csl-entry" role="listitem">
Puggaard-Rode, Rasmus. 2022a. Data and code for chapters 5 and 6 of <span>“<span>Stop</span>! Hey, what’s that sound?”</span> <em>DataverseNL</em>. doi:<a href="https://doi.org/10.34894/FJKFD1">10.34894/FJKFD1</a>.
</div>
<div id="ref-puggaardrode2023_diss" class="csl-entry" role="listitem">
Puggaard-Rode, Rasmus. 2023. <em>Stop! Hey, what’s that sound? The representation and realization of <span>Danish</span> stops</em> (<span>LOT</span> Dissertation Series 631). Amsterdam: Netherlands Graduate School of Linguistics. doi:<a href="https://doi.org/10.48273/LOT0631">10.48273/LOT0631</a>.
</div>
<div id="ref-r2022" class="csl-entry" role="listitem">
R Core Team. 2022. <em>R. A language and environment for statistical computing</em>. Version 4.2.2. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-reidy2013" class="csl-entry" role="listitem">
Reidy, Patrick F. 2013. An introduction to random processes for the spectral analysis of speech data. <em>Ohio State University Working Papers in Linguistics</em> 60, 67–116.
</div>
<div id="ref-schad2020" class="csl-entry" role="listitem">
Schad, Daniel J., Shravan Vasishth, Sven Hohenstein &amp; Reinhold Kliegl. 2020. How to capitalize on a priori contexts in linear (mixed) models. A tutorial. <em>Journal of Memory and Language</em> 110. doi:<a href="https://doi.org/10.1016/j.jml.2019.104038">10.1016/j.jml.2019.104038</a>.
</div>
<div id="ref-shadle1996" class="csl-entry" role="listitem">
Shadle, Christine H. &amp; Sheila J. Mair. 1996. Quantifying spectral characteristics of fricatives. <em><span class="nocase">Fourth International Conference on Spoken Language Processing</span></em>, 1521–1524. Philadelphia: International Speech Communication Association.
</div>
<div id="ref-skautrup1970" class="csl-entry" role="listitem">
Skautrup, Peter, Ove Rasmussen, Viggo Sørensen, Torben Arboe, Inger Schoonderbeek Hansen, Nina Grøftehauge, Mette-Marie Møller Svendsen &amp; Kristoffer Friis Bøegh. 1970–. <em>Jysk ordbog</em>. Aarhus: Aarhus University.
</div>
<div id="ref-skjelborg1967" class="csl-entry" role="listitem">
Skjelborg, Åge. 1967. <em>Topografisk ordning af <span>Danmarks</span> egne med alfabetisk nøgle</em>. Copenhagen: Statens Trykningskontor.
</div>
<div id="ref-stevens1993" class="csl-entry" role="listitem">
Stevens, Kenneth N. 1993. Models for the production and acoustics of stop consonants. <em>Speech Communication</em> 13(3), 367–375. doi:<a href="https://doi.org/10.1016/0167-6393(93)90035-J">10.1016/0167-6393(93)90035-J</a>.
</div>
<div id="ref-stevens1998" class="csl-entry" role="listitem">
Stevens, Kenneth N. 1998. <em>Acoustic phonetics</em>. Cambridge, <span>MA</span>: <span>MIT</span> Press. doi:<a href="https://doi.org/10.7551/mitpress/1072.001.0001">10.7551/mitpress/1072.001.0001</a>.
</div>
<div id="ref-stoelgammon1994" class="csl-entry" role="listitem">
Stoel-Gammon, Carol, Karen A. Williams &amp; Eugene Buder. 1994. Cross-language differences in phonological acquisition. Swedish and <span>American</span> /t/. <em>Phonetica</em> 51(1), 146–158. doi:<a href="https://doi.org/10.1159/000261966">10.1159/000261966</a>.
</div>
<div id="ref-vanrij2016" class="csl-entry" role="listitem">
van Rij, Jacolien. 2016. Testing for significance. R package vignette, ms. <a href="https://cran.r-project.org/web/packages/itsadug/vignettes/test.html">https://cran.r-project.org/web/packages/itsadug/vignettes/test.html</a>.
</div>
<div id="ref-itsadug" class="csl-entry" role="listitem">
van Rij, Jacolien, Martijn Wieling, R. Harald Baayen &amp; Hedderik van Rijn. 2022. <code>itsadug</code>. Interpreting time series and autocorrelated data using GAMMs. Version 2.4.1. <a href="https://CRAN.R-project.org/package=itsadug">https://CRAN.R-project.org/package=itsadug</a>.
</div>
<div id="ref-wieling2011" class="csl-entry" role="listitem">
Wieling, Martijn, John Nerbonne &amp; R. Harald Baayen. 2011. Quantitative social dialectology. Explaining linguistic variation geographically and socially. <em>Plos One</em> 6(9). doi:<a href="https://doi.org/10.1371/journal.pone.0023613">10.1371/journal.pone.0023613</a>.
</div>
<div id="ref-wood2003" class="csl-entry" role="listitem">
Wood, Simon N. 2003. Thin plate regression splines. <em>Journal of the Royal Statistical Society B</em> 65(1), 95–114. doi:<a href="https://doi.org/10.1111/1467-9868.00374">10.1111/1467-9868.00374</a>.
</div>
<div id="ref-wood2022" class="csl-entry" role="listitem">
Wood, Simon N. 2022. <code>mgcv</code>. <em>Mixed GAM computation vehicle with automatic smoothness estimation</em>. Version 1.8-41. <a href="https://CRAN.R-project.org/package=mgcv">https://CRAN.R-project.org/package=mgcv</a>.
</div>
<div id="ref-fdapace" class="csl-entry" role="listitem">
Zhou, Yidong, Satarupa Bhattacharjee, Cody Carroll, Yaqing Chen, Xiongtai Dai, Jianing Fan, Alvaro Gajardo, et al. 2022. <code>fdapace</code>. Functional data analysis and empirical dynamics. Version 0.5.9. <a href="https://CRAN.R-project.org/package=fdapace">https://CRAN.R-project.org/package=fdapace</a>.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{puggaard-rode2023,
  author = {Puggaard-Rode, Rasmus},
  title = {The /t/ Release in {Jutland} {Danish.} {Decomposing} the
    Spectrum with Functional {PCA}},
  journal = {Proceedings of the International Congress of Phonetic
    Sciences},
  volume = {20},
  date = {2023-08-02},
  langid = {en},
  abstract = {This study concerns variation in the realization of /t/ in
    Danish. /t/ is prominently affricated in Modern Standard Danish, but
    affrication is known to have been missing in some of the regional
    varieties that used to be spoken in Jutland. It remains unclear
    exactly which varieties lacked affrication. Due to relatively recent
    major changes in language policy and mobility, the traditional
    Danish dialect landscape has undergone rapid levelling, so we
    explore this problem using a large corpus of recordings of elderly
    speakers from the 1970s. We propose using the functional extension
    of principal component analysis to decompose the sources of spectral
    variance in stop release midpoints, and use the results as a proxy
    for determining affrication status. We find that /t/ affrication was
    limited to parts of eastern Jutland, perhaps due to early adaptation
    of the feature in some of the area’s largest cities.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-puggaard-rode2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Puggaard-Rode, Rasmus. 2023. The /t/ release in Jutland Danish.
Decomposing the spectrum with functional PCA. <em>Proceedings of the
International Congress of Phonetic Sciences</em> 20.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>